hive -e "drop table adndata.mapper_moptt_board"
hive -e "CREATE EXTERNAL TABLE adndata.mapper_moptt_board( board_tag string, board string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.adn/hive/warehouse/mapper_moptt_board'"
hive -e "msck repair table adndata.mapper_moptt_board"
hive -e "drop table adndata.seg_ad_inferred_gender"
hive -e "CREATE EXTERNAL TABLE adndata.seg_ad_inferred_gender( gender string, value string, imei string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.adn/hive/warehouse/seg_ad_inferred_gender'"
hive -e "msck repair table adndata.seg_ad_inferred_gender"
hive -e "drop table adndata.segment_mapping_table"
hive -e "CREATE EXTERNAL TABLE adndata.segment_mapping_table( sales_segment_ch string, sales_segment_en string, offer_category_ch string, offer_category_en string, offer_category_code string, offer_category_index string, definition string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.adn/hive/warehouse/segment_mapping_table'"
hive -e "msck repair table adndata.segment_mapping_table"
hive -e "drop table bmart.profile_gender_prediction"
hive -e "CREATE EXTERNAL TABLE bmart.profile_gender_prediction( mid string, model_type string, gaid string, confidence_level float, label bigint) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.mart/hive/warehouse/bmart.profile_gender_prediction'"
hive -e "msck repair table bmart.profile_gender_prediction"
hive -e "drop table default.mapper_quadkey_city_tw_test"
hive -e "CREATE EXTERNAL TABLE default.mapper_quadkey_city_tw_test( quadkey string, city string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/internal.source/mapper_quadkey_city_tw'"
hive -e "msck repair table default.mapper_quadkey_city_tw_test"
hive -e "drop table default.profile_device_app_detection_date_range"
hive -e "CREATE EXTERNAL TABLE default.profile_device_app_detection_date_range( pkg string, dt_min string, dt_max string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp/hive/warehouse/profile_device_app_detection_date_range'"
hive -e "msck repair table default.profile_device_app_detection_date_range"
hive -e "drop table default.profile_device_app_detection_gaid_uu"
hive -e "CREATE EXTERNAL TABLE default.profile_device_app_detection_gaid_uu( pkg string, gaid string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp/hive/warehouse/profile_device_app_detection_gaid_uu'"
hive -e "msck repair table default.profile_device_app_detection_gaid_uu"
hive -e "drop table default.profile_device_browser_dt"
hive -e "CREATE EXTERNAL TABLE default.profile_device_browser_dt( sdk_name string, imei string, browser string, dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_browser_dt'"
hive -e "msck repair table default.profile_device_browser_dt"
hive -e "drop table dmpdata.app_log_tw"
hive -e "CREATE EXTERNAL TABLE dmpdata.app_log_tw( create_at string, action_type string, ad_id string, cell_id string, cost_points double, device_id string, device_name string, device_os_name string, device_os_version string, imei string, lac string, lat double, license_key string, lon double, mcc string, mnc string, quad_key string, record_at string, screen_height smallint, screen_width smallint, sdk_name string, sdk_version string, user_agent string, ip string, request tinyint, impression tinyint, click tinyint, dollar_id string, share_points double, telcom string, poi_id string, device_full_name string, latlon_source string, network_info string, mac_id string, backup_id string, android_id string, mac_address string, location_accuracy double, network_operator_name string, density double, req_ad_height smallint, req_ad_width smallint, ad_class smallint, goal_id string, display_width int, display_height int, ad_width int, ad_height int, is_low_price boolean, true_imei string, user_req_width int, user_req_height int, user_network_info int, user_ip string, status int, device_brand string, guid string, sid string, seq string, req_ad_fmt string, adv_id string, age smallint, birthday string, gender tinyint, app_name string, keyword string, lang string, msid string, bssid string, capability string, gaid string, n_mcc string, n_mnc string, ex string, sdk_build_number string, limit_ad_tracking boolean, is_https boolean) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.columnar.ColumnarSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.RCFileOutputFormat' LOCATION 's3://vpon.dmp.input.prod/adn.app_log/app_log_tw'"
hive -e "msck repair table dmpdata.app_log_tw"
hive -e "drop table dmpdata.ec_checkout_data"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_checkout_data( license_key string, checkout_id string, server_timestamp bigint, ip_address string, user_agent string, medium string, refer_page string, session_id string, custom_id string, sdk_name string, sdk_version string, client_device string, client_id string, vpon_id string, gaid string, idfa string, click_id string, campaign_source string, src_agency string, src_platform string, src_stragyid string, campaign_id string, ad_id string, banner_id string, event string, payload string, create_at string, create_at_hr string, weekday string, 1st_id string, currency string, total_price string, shipping string, item_list string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_checkout_data'"
hive -e "msck repair table dmpdata.ec_checkout_data"
hive -e "drop table dmpdata.ec_comefrom_funnel"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_comefrom_funnel( license_key string, come_from string, vpon_or_not string, src_agency string, src_platform string, src_stragyid string, event string, num_cid_u bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_comefrom_funnel'"
hive -e "msck repair table dmpdata.ec_comefrom_funnel"
hive -e "drop table dmpdata.ec_daily_come_from"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_daily_come_from( license_key string, come_from string, vpon_or_not string, src_agency string, src_platform string, src_stragyid string, client_id string, records bigint, num_sid bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_daily_come_from'"
hive -e "msck repair table dmpdata.ec_daily_come_from"
hive -e "drop table dmpdata.ec_daily_funnel"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_daily_funnel( license_key string, event string, medium string, page_views bigint, num_sid bigint, num_cid_u bigint, num_vid_u bigint, num_mid_u bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_daily_funnel'"
hive -e "msck repair table dmpdata.ec_daily_funnel"
hive -e "drop table dmpdata.ec_daily_pvconvert"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_daily_pvconvert( license_key string, medium string, title string, viewers bigint, checkout_ucid_num bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_daily_pvconvert'"
hive -e "msck repair table dmpdata.ec_daily_pvconvert"
hive -e "drop table dmpdata.ec_hourly_comefrom_cvr"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_hourly_comefrom_cvr( license_key string, medium string, title string, viewers bigint, checkout_ucid_num bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_hourly_comefrom_cvr'"
hive -e "msck repair table dmpdata.ec_hourly_comefrom_cvr"
hive -e "drop table dmpdata.ec_rfm"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_rfm( license_key string, 1st_id_dt string, recency string, frequency int, monetary int, recency_num int, recency_median int, r_level int, frequency_median int, f_level int, monetary_median int, m_level int, rfm_level int) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_rfm'"
hive -e "msck repair table dmpdata.ec_rfm"
hive -e "drop table dmpdata.ec_time_uus"
hive -e "CREATE EXTERNAL TABLE dmpdata.ec_time_uus( time_range string, license_key string, month string, create_at_hr string, medium string, page_views bigint, num_sid bigint, num_cid_u bigint, num_vid_u bigint, num_mid_u bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/ec_time_uus'"
hive -e "msck repair table dmpdata.ec_time_uus"
hive -e "drop table dmpdata.event_tracking"
hive -e "CREATE EXTERNAL TABLE dmpdata.event_tracking( server_timestamp bigint, ip_address string, user_agent string, refer_page string, event_timestamp bigint, session_id string, custom_id string, sdk_name string, sdk_version string, license_key string, encoding string, client_device string, client_id string, vpon_id string, gaid string, idfa string, click_id string, campaign_source string, campaign_id string, ad_id string, banner_id string, event string, payload string, create_at string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/event_tracking'"
hive -e "msck repair table dmpdata.event_tracking"
hive -e "drop table dmpdata.event_tracking_ec_item_dt"
hive -e "CREATE EXTERNAL TABLE dmpdata.event_tracking_ec_item_dt( server_timestamp bigint, ip_address string, user_agent string, medium string, refer_page string, session_id string, custom_id string, sdk_name string, sdk_version string, license_key string, client_device string, client_id string, vpon_id string, gaid string, idfa string, click_id string, campaign_source string, src_agency string, src_platform string, src_stragyid string, campaign_id string, ad_id string, banner_id string, event string, payload string, create_at string, create_at_hr string, weekday string, 1st_id string, currency string, total_price string, shipping string, checkout_id string, checkout_item_id string, checkout_item_name string, checkout_item_count int, checkout_item_price int) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/event_tracking_ec_item_dt'"
hive -e "msck repair table dmpdata.event_tracking_ec_item_dt"
hive -e "drop table dmpdata.event_tracking_ec_parse_dt"
hive -e "CREATE EXTERNAL TABLE dmpdata.event_tracking_ec_parse_dt( server_timestamp bigint, ip_address string, user_agent string, medium string, refer_page string, session_id string, custom_id string, sdk_name string, sdk_version string, client_device string, client_id string, vpon_id string, gaid string, idfa string, click_id string, campaign_source string, src_agency string, src_platform string, src_stragyid string, campaign_id string, ad_id string, banner_id string, event string, payload string, create_at string, create_at_hr string, weekday string, title string, current string, previous string, 1st_id string, id string, name string, price bigint, tags string, currency string, keyword string, 3rd_id string, 3rd_type string, total_price string, shipping string, checkout_id string, item_list string) PARTITIONED BY ( dt string, license_key string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/event_tracking_ec_parse_dt'"
hive -e "msck repair table dmpdata.event_tracking_ec_parse_dt"
hive -e "drop table dmpdata.imei_by_app"
hive -e "CREATE EXTERNAL TABLE dmpdata.imei_by_app( sdk_name string, app_id string, app_name string, ad_unit string, imei string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp/hive/warehouse/dmpdata.imei_by_app'"
hive -e "msck repair table dmpdata.imei_by_app"
hive -e "drop table dmpdata.imei_by_country_platform"
hive -e "CREATE EXTERNAL TABLE dmpdata.imei_by_country_platform( country string, sdk_name string, imei string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/dmpdata.imei_by_country_platform'"
hive -e "msck repair table dmpdata.imei_by_country_platform"
hive -e "drop table dmpdata.mapper_ad_accounting"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_ad_accounting( ad_id string, cost_point string, cost_type string, update_at string) PARTITIONED BY ( owner string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/mapper_ad_accounting'"
hive -e "msck repair table dmpdata.mapper_ad_accounting"
hive -e "drop table dmpdata.mapper_ad_info"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_ad_info( ad_platform string, ad_id string, ad_name string, ad_mode int, ad_mode_name string, ad_creative_tag string, ad_type int, ad_type_name string, campaign_id string, campaign_name string, campaign_offer_category_tag string, campaign_purpose_tag string, email_advertiser string, advertiser_region string, ad_update_at string) PARTITIONED BY ( owner string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/mapper_ad_info'"
hive -e "msck repair table dmpdata.mapper_ad_info"
hive -e "drop table dmpdata.mapper_app_info"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_app_info( banner_id string, banner_name string, ad_unit string, app_id string, app_name string, cat string, target_os string, user_id string, currency string, publisher_region string, app_update_at string) PARTITIONED BY ( owner string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/mapper_app_info'"
hive -e "msck repair table dmpdata.mapper_app_info"
hive -e "drop table dmpdata.mapper_ec_client2member_dt"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_ec_client2member_dt( license_key string, client_id string, 1st_id string, 1st_ids bigint) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/mapper_ec_client2member_dt'"
hive -e "msck repair table dmpdata.mapper_ec_client2member_dt"
hive -e "drop table dmpdata.mapper_quadkey_city_tw"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_quadkey_city_tw( quadkey string, city string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/internal.source/mapper_quadkey_city_tw'"
hive -e "msck repair table dmpdata.mapper_quadkey_city_tw"
hive -e "drop table dmpdata.mapper_quadkey_country"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_quadkey_country( quadkey string, country string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/mapper_quadkey_country'"
hive -e "msck repair table dmpdata.mapper_quadkey_country"
hive -e "drop table dmpdata.mapper_quadkey_region_hk"
hive -e "CREATE EXTERNAL TABLE dmpdata.mapper_quadkey_region_hk( quadkey string, region string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/internal.source/mapper_quadkey_region_hk'"
hive -e "msck repair table dmpdata.mapper_quadkey_region_hk"
hive -e "drop table dmpdata.profile_device_app_detection_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_app_detection_date( gaid string, pkg string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/adn.app_detection/profile_device_app_detection_date'"
hive -e "msck repair table dmpdata.profile_device_app_detection_date"
hive -e "drop table dmpdata.profile_device_app_detection_date_range"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_app_detection_date_range( pkg string, dt_min string, dt_max string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/dmpdata.profile_device_app_detection_date_range'"
hive -e "msck repair table dmpdata.profile_device_app_detection_date_range"
hive -e "drop table dmpdata.profile_device_app_detection_gaid_uu"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_app_detection_gaid_uu( pkg string, gaid string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/dmpdata.profile_device_app_detection_gaid_uu'"
hive -e "msck repair table dmpdata.profile_device_app_detection_gaid_uu"
hive -e "drop table dmpdata.profile_device_apps_adn_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_apps_adn_date( sdk_name string, imei string, app_name string, app_id string, create_at_date string, create_at_hour string, url string, email string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_apps_adn_date'"
hive -e "msck repair table dmpdata.profile_device_apps_adn_date"
hive -e "drop table dmpdata.profile_device_apps_ats_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_apps_ats_date( sdk_name string, imei string, goal_id string, goal_name string, action_type string, create_at_date string, create_at_hour string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_apps_ats_date'"
hive -e "msck repair table dmpdata.profile_device_apps_ats_date"
hive -e "drop table dmpdata.profile_device_board_title_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_board_title_date( imei string, board string, title string, create_at_date string, create_at_hour string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_board_title_date'"
hive -e "msck repair table dmpdata.profile_device_board_title_date"
hive -e "drop table dmpdata.profile_device_brand_model_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_brand_model_date( sdk_name string, imei string, device_brand string, device_name string, device_full_name string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_brand_model_date'"
hive -e "msck repair table dmpdata.profile_device_brand_model_date"
hive -e "drop table dmpdata.profile_device_browser_dt"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_browser_dt( sdk_name string, imei string, browser string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_browser_dt'"
hive -e "msck repair table dmpdata.profile_device_browser_dt"
hive -e "drop table dmpdata.profile_device_campaign_email_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_campaign_email_date( sdk_name string, imei string, campaign_id string, campaign_name string, email string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_campaign_email_date'"
hive -e "msck repair table dmpdata.profile_device_campaign_email_date"
hive -e "drop table dmpdata.profile_device_offer_category_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_offer_category_date( sdk_name string, offer_category string, imei string, create_at_date string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_offer_category_date'"
hive -e "msck repair table dmpdata.profile_device_offer_category_date"
hive -e "drop table dmpdata.profile_device_response_basis_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_device_response_basis_date( quad_key string, sdk_name string, sdk_version string, status int, imei string, create_at_date string, create_at_hr int, banner_id string, banner_name string, ad_unit string, cat string, app_id string, app_name string, target_os string, user_id_publisher string, currency_publisher string, ad_platform string, ad_id string, ad_name string, ad_mode int, ad_mode_name string, ad_creative_tag string, ad_type int, ad_type_name string, cost_type string, cost_type_point string, ad_type_keyword string, campaign_id string, campaign_name string, campaign_offer_category_tag string, campaign_purpose_tag string, email_advertiser string, advertiser_region string, reqs bigint, reqs_test bigint, reqs_static bigint, reqs_uncounted bigint, reqs_invalid bigint, imps_candidate bigint, imps_effective bigint, imps_test bigint, imps_static bigint, imps_uncounted bigint, imps_invalid bigint, clks bigint, clks_test bigint, clks_static bigint, clks_uncounted bigint, clks_invalid bigint, share_points double, cost_points double) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_response_basis_date'"
hive -e "msck repair table dmpdata.profile_device_response_basis_date"
hive -e "drop table dmpdata.profile_inventory_city_tw_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_inventory_city_tw_date( create_at_date string, city string, sdk_name string, sdk_version string, ad_unit string, imei string, reqs bigint, imps_candidate bigint, imps_effective bigint, clks bigint, fillrate double, effective_ratio double, inventory double, ctr double, share_points double, cost_points double) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_inventory_city_tw_date'"
hive -e "msck repair table dmpdata.profile_inventory_city_tw_date"
hive -e "drop table dmpdata.profile_inventory_country_app_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_inventory_country_app_date( country string, create_at_date string, app_name string, banner_name string, app_category string, sdk_name string, sdk_version string, ad_unit string, reqs bigint, imps_candidate bigint, imps_effective bigint, clks bigint, fillrate double, effective_ratio double, inventory double, ctr double, share_points double, cost_points double, req_uu bigint, imp_candidate_uu bigint, imp_effective_uu bigint, clk_uu bigint, app_id string, banner_id string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_inventory_country_app_date'"
hive -e "msck repair table dmpdata.profile_inventory_country_app_date"
hive -e "drop table dmpdata.profile_inventory_country_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_inventory_country_date( create_at_date string, country string, sdk_name string, sdk_version string, ad_unit string, imei string, reqs bigint, imps_candidate bigint, imps_effective bigint, clks bigint, fillrate double, effective_ratio double, inventory double, ctr double, share_points double, cost_points double) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_inventory_country_date'"
hive -e "msck repair table dmpdata.profile_inventory_country_date"
hive -e "drop table dmpdata.profile_inventory_region_hk_date"
hive -e "CREATE EXTERNAL TABLE dmpdata.profile_inventory_region_hk_date( create_at_date string, region string, sdk_name string, sdk_version string, ad_unit string, imei string, reqs bigint, imps_candidate bigint, imps_effective bigint, clks bigint, fillrate double, effective_ratio double, inventory double, ctr double, share_points double, cost_points double) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_inventory_region_hk_date'"
hive -e "msck repair table dmpdata.profile_inventory_region_hk_date"
hive -e "drop table dmpdata.social_account"
hive -e "CREATE EXTERNAL TABLE dmpdata.social_account( create_ts bigint, banner_id string, gaid string, android_id string, imei string, create_at string, account_name string, account_value string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.SequenceFileInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveSequenceFileOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/dmpdata.social_account'"
hive -e "msck repair table dmpdata.social_account"
hive -e "drop table dspdata.beacons_k2s3"
hive -e "CREATE EXTERNAL TABLE dspdata.beacons_k2s3( beacon_type int, unix_ts bigint, click_id string, click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://bidding-engine-data-sourcing/beacons'"
hive -e "msck repair table dspdata.beacons_k2s3"
hive -e "drop table dspdata.beacons_k2s3_a"
hive -e "CREATE EXTERNAL TABLE dspdata.beacons_k2s3_a( beacon_type int, unix_ts bigint, click_id string, click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3a://bidding-engine-data-sourcing/beacons'"
hive -e "msck repair table dspdata.beacons_k2s3_a"
hive -e "drop table dspdata.bidding_log"
hive -e "CREATE EXTERNAL TABLE dspdata.bidding_log( click_id string, bid_price double, ctr_pred double, ctr_price double, ctr_ver bigint, ivr_pred double, ivr_price double, ivr_ver bigint) PARTITIONED BY ( click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dsp/bidding_log'"
hive -e "msck repair table dspdata.bidding_log"
hive -e "drop table dspdata.conv_log"
hive -e "CREATE EXTERNAL TABLE dspdata.conv_log( click_id string, unix_ts int) PARTITIONED BY ( conv string, click_day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3a://vpon.dsp/conv_log'"
hive -e "msck repair table dspdata.conv_log"
hive -e "drop table dspdata.dsp_beacons_click_action"
hive -e "CREATE EXTERNAL TABLE dspdata.dsp_beacons_click_action( beacon_type int, unix_ts int, click_id string, click_day int, rec_date string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3a://vpon-dsp-data-prod/dsp_beacons_click_action'"
hive -e "msck repair table dspdata.dsp_beacons_click_action"
hive -e "drop table dspdata.dsp_wonbid_clickday"
hive -e "CREATE EXTERNAL TABLE dspdata.dsp_wonbid_clickday( clickid string, tracking int, unitprice double, unixts bigint, site string, placement string, creativewebid string, campaignid string, campaignwebid string, advertiserid string, lineitemid string, currencyver bigint, platformid string, mediacost double, bidprice double, actualbidprice double, clearprice double, bidinfo struct<campaign:struct<advertiserCode:string,advertiserWebId:string,campaignId:bigint,campaignCode:string,campaignWebId:string,insertionOrderCode:string,insertionOrderWebId:string,lineItemId:bigint,lineItemCode:string,lineItemWebId:string,currency:string,keywords:string,minPrice:double,maxPrice:double>,creative:struct<encodedClickUrl:string,clickUrl:string,creativeCode:string,creativeHeight:string,creativeId:string,creativeSize:string,creativeWidth:string,creativeCoreId:string>,device:struct<deviceMakeId:string,deviceModelId:string,carrierId:string,carrierMcc:string,carrierMnc:string,encodedUserAgent:string,userAgent:string,userCity:string,userCountry:string,userState:string,geoLat:string,geoLon:string,userIp:string,dnt:int,languages:array<string>,os:string,osv:string,conectionType:int,devicetype:array<int>,density:float>,deviceId:struct<deviceImei:string,deviceImeiMd5:string,deviceImeiMd5Lowercase:string,deviceMacMd51:string,deviceAndroidId:string,deviceAndroidIdMd5:string,deviceUdidMd5:string,deviceAppleIda:string,deviceAppleIdaMd5Lowercase:string,deviceGaid:string,deviceGaidMd5:string,deviceDid:string>,user:struct<age:int,gender:string,userId:string>,source:struct<inventorySourceId:string,publisherId:string,encodedReferrerUrl:string,referrerUrl:string,siteId:string,extAppId:string,placementId:string,currency:string,domain:string,cat:array<string>,sectionCat:array<string>,pageCat:array<string>,keywords:array<string>,bundle:string,paid:int,content:struct<id:string,cat:array<string>,producer:struct<id:string,cat:array<string>>,languages:array<string>>,publisher:struct<id:string,cat:array<string>>>,timestamp:bigint,auctionId:string,cacheBuster:string,clickId:string,bidPrice:struct<inCampaignCurrency:double,inUSD:double,inSourceCurrency:double,actualInCampaignCurrency:double,actualInUSD:double,actualInSourceCurrency:double,exchangeRateVersion:bigint>,wonPrice:struct<clearInUSD:double,clearInSourceCurrency:double,mediaPriceInCampaignCurrency:double,mediaPriceInUSD:double,mediaCostInCampaignCurrency:double,mediaCostInUSD:double,intermediateFee:struct<preVATTax1:double,preWHTTax1:double,preVATTax2:double,preWHTTax2:double,postVATTax1:double,postWHTTax1:double,postVATTax2:double,postWHTTax2:double,serviceCharge:double,exchangeRateMarkup:double>,exchangeRateVersion:bigint>,sourceCurrency:string,bidFloor:double,bidNodeId:string,instl:int,position:array<int>,battr:array<int>,badv:array<string>,bsens:array<string>,bcat:array<string>,bidEngineInfo:array<struct<biddingEngine:string,biddingPrice:double,mode:bigint,ctrPredictionVersion:bigint,predictedCTR:double>>,isApp:boolean>) PARTITIONED BY ( click_day int, rec_date string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon-dsp-data-prod/dsp_wonbid_clickday'"
hive -e "msck repair table dspdata.dsp_wonbid_clickday"
hive -e "drop table dspdata.raw_request_google"
hive -e "CREATE EXTERNAL TABLE dspdata.raw_request_google( ) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.openx.data.jsonserde.JsonSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3a://vpon.dsp/raw_request/ssp=google'"
hive -e "msck repair table dspdata.raw_request_google"
hive -e "drop table dspdata.raw_request_mopub"
hive -e "CREATE EXTERNAL TABLE dspdata.raw_request_mopub( ) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.openx.data.jsonserde.JsonSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3a://vpon.dsp/raw_request/ssp=mopub'"
hive -e "msck repair table dspdata.raw_request_mopub"
hive -e "drop table dspdata.seg_qshop_pageview"
hive -e "CREATE EXTERNAL TABLE dspdata.seg_qshop_pageview( device_id string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3a://vpon.dsp/seg_qshop_pageview'"
hive -e "msck repair table dspdata.seg_qshop_pageview"
hive -e "drop table dspdata.traffic_log"
hive -e "CREATE EXTERNAL TABLE dspdata.traffic_log( unix_ts int, click_id string, bid_price double, ssp_id int, device_id string, vpon_site_id bigint, vpon_placement_id bigint, ip string, path string, be_info string) PARTITIONED BY ( agent int, dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon-dsp-data-prod/dsp_agent_traffic_log'"
hive -e "msck repair table dspdata.traffic_log"
hive -e "drop table dspdata.uber_conv"
hive -e "CREATE EXTERNAL TABLE dspdata.uber_conv( click_id string, click int, action int, install int, ft int) PARTITIONED BY ( click_day int) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3a://vpon.dsp/uber_conv'"
hive -e "msck repair table dspdata.uber_conv"
hive -e "drop table dspdata.uber_wonbid_conv"
hive -e "CREATE EXTERNAL TABLE dspdata.uber_wonbid_conv( click_id string, unix_ts bigint, mediacost double, click int, action int, install int, ft int, creativewebid string, platformid string, bidinfo struct<campaign:struct<advertisercode:string,advertiserwebid:string,campaignid:bigint,campaigncode:string,campaignwebid:string,insertionordercode:string,insertionorderwebid:string,lineitemid:bigint,lineitemcode:string,lineitemwebid:string,currency:string,keywords:string,minprice:double,maxprice:double>,creative:struct<encodedclickurl:string,clickurl:string,creativecode:string,creativeheight:string,creativeid:string,creativesize:string,creativewidth:string,creativecoreid:string>,device:struct<devicemakeid:string,devicemodelid:string,carrierid:string,carriermcc:string,carriermnc:string,encodeduseragent:string,useragent:string,usercity:string,usercountry:string,userstate:string,geolat:string,geolon:string,userip:string,dnt:int,languages:array<string>,os:string,osv:string,conectiontype:int,devicetype:array<int>,density:float>,deviceid:struct<deviceimei:string,deviceimeimd5:string,deviceimeimd5lowercase:string,devicemacmd51:string,deviceandroidid:string,deviceandroididmd5:string,deviceudidmd5:string,deviceappleida:string,deviceappleidamd5lowercase:string,devicegaid:string,devicegaidmd5:string,devicedid:string>,user:struct<age:int,gender:string,userid:string>,source:struct<inventorysourceid:string,publisherid:string,encodedreferrerurl:string,referrerurl:string,siteid:string,extappid:string,placementid:string,currency:string,domain:string,cat:array<string>,sectioncat:array<string>,pagecat:array<string>,keywords:array<string>,bundle:string,paid:int,content:struct<id:string,cat:array<string>,producer:struct<id:string,cat:array<string>>,languages:array<string>>,publisher:struct<id:string,cat:array<string>>>,timestamp:bigint,auctionid:string,cachebuster:string,clickid:string,bidprice:struct<incampaigncurrency:double,inusd:double,insourcecurrency:double,actualincampaigncurrency:double,actualinusd:double,actualinsourcecurrency:double,exchangerateversion:bigint>,wonprice:struct<clearinusd:double,clearinsourcecurrency:double,mediapriceincampaigncurrency:double,mediapriceinusd:double,mediacostincampaigncurrency:double,mediacostinusd:double,intermediatefee:struct<prevattax1:double,prewhttax1:double,prevattax2:double,prewhttax2:double,postvattax1:double,postwhttax1:double,postvattax2:double,postwhttax2:double,servicecharge:double,exchangeratemarkup:double>,exchangerateversion:bigint>,sourcecurrency:string,bidfloor:double,bidnodeid:string,instl:int,position:array<int>,battr:array<int>,badv:array<string>,bsens:array<string>,bcat:array<string>,bidengineinfo:array<struct<biddingengine:string,biddingprice:double,mode:bigint,ctrpredictionversion:bigint,predictedctr:double>>,isapp:boolean>) PARTITIONED BY ( click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dsp/uber_wonbid_conv'"
hive -e "msck repair table dspdata.uber_wonbid_conv"
hive -e "drop table dspdata.wonbid_bidding"
hive -e "CREATE EXTERNAL TABLE dspdata.wonbid_bidding( click double, action double, platform int, advertiser int, lineitem int, campaign int, sspid int, clearprice double, bidprice double, ctr_pred double, ctr_price double, ctr_ver bigint, ivr_pred double, ivr_price double, ivr_ver bigint, winner string) PARTITIONED BY ( click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3a://vpon.dsp/wonbid_bidding'"
hive -e "msck repair table dspdata.wonbid_bidding"
hive -e "drop table dspdata.wonbids_k2s3"
hive -e "CREATE EXTERNAL TABLE dspdata.wonbids_k2s3( clickid string, tracking int, unitprice double, unixts bigint, site string, placement string, creativewebid string, campaignid string, campaignwebid string, advertiserid string, lineitemid string, currencyver bigint, platformid string, mediacost double, bidprice double, actualbidprice double, clearprice double, bidinfo struct<campaign:struct<advertiserCode:string,advertiserWebId:string,campaignId:bigint,campaignCode:string,campaignWebId:string,insertionOrderCode:string,insertionOrderWebId:string,lineItemId:bigint,lineItemCode:string,lineItemWebId:string,currency:string,keywords:string,minPrice:double,maxPrice:double>,creative:struct<encodedClickUrl:string,clickUrl:string,creativeCode:string,creativeHeight:string,creativeId:string,creativeSize:string,creativeWidth:string,creativeCoreId:string>,device:struct<deviceMakeId:string,deviceModelId:string,carrierId:string,carrierMcc:string,carrierMnc:string,encodedUserAgent:string,userAgent:string,userCity:string,userCountry:string,userState:string,geoLat:string,geoLon:string,userIp:string,dnt:int,languages:array<string>,os:string,osv:string,conectionType:int,devicetype:array<int>,density:float>,deviceId:struct<deviceImei:string,deviceImeiMd5:string,deviceImeiMd5Lowercase:string,deviceMacMd51:string,deviceAndroidId:string,deviceAndroidIdMd5:string,deviceUdidMd5:string,deviceAppleIda:string,deviceAppleIdaMd5Lowercase:string,deviceGaid:string,deviceGaidMd5:string,deviceDid:string>,user:struct<age:int,gender:string,userId:string>,source:struct<inventorySourceId:string,publisherId:string,encodedReferrerUrl:string,referrerUrl:string,siteId:string,extAppId:string,placementId:string,currency:string,domain:string,cat:array<string>,sectionCat:array<string>,pageCat:array<string>,keywords:array<string>,bundle:string,paid:int,content:struct<id:string,cat:array<string>,producer:struct<id:string,cat:array<string>>,languages:array<string>>,publisher:struct<id:string,cat:array<string>>>,timestamp:bigint,auctionId:string,cacheBuster:string,clickId:string,bidPrice:struct<inCampaignCurrency:double,inUSD:double,inSourceCurrency:double,actualInCampaignCurrency:double,actualInUSD:double,actualInSourceCurrency:double,exchangeRateVersion:bigint>,wonPrice:struct<clearInUSD:double,clearInSourceCurrency:double,mediaPriceInCampaignCurrency:double,mediaPriceInUSD:double,mediaCostInCampaignCurrency:double,mediaCostInUSD:double,intermediateFee:struct<preVATTax1:double,preWHTTax1:double,preVATTax2:double,preWHTTax2:double,postVATTax1:double,postWHTTax1:double,postVATTax2:double,postWHTTax2:double,serviceCharge:double,exchangeRateMarkup:double>,exchangeRateVersion:bigint>,sourceCurrency:string,bidFloor:double,bidNodeId:string,instl:int,position:array<int>,battr:array<int>,badv:array<string>,bsens:array<string>,bcat:array<string>,bidEngineInfo:array<struct<biddingEngine:string,biddingPrice:double,mode:bigint,ctrPredictionVersion:bigint,predictedCTR:double>>,isApp:boolean>) PARTITIONED BY ( click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://bidding-engine-data-sourcing/wonbids'"
hive -e "msck repair table dspdata.wonbids_k2s3"
hive -e "drop table dspdata.zalora_wonbid_bidding"
hive -e "CREATE EXTERNAL TABLE dspdata.zalora_wonbid_bidding( click double, action double, platform int, advertiser int, lineitem int, campaign int, sspid int, clearprice double, bidprice double, ctr_pred double, ctr_price double, ctr_ver bigint, ivr_pred double, ivr_price double, ivr_ver bigint, winner string) PARTITIONED BY ( click_day int) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3a://vpon.dsp/zalora_wonbid_bidding'"
hive -e "msck repair table dspdata.zalora_wonbid_bidding"
hive -e "drop table pardata.appnexus_map_browser"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_browser( id string, name string, platform_type string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_browser'"
hive -e "msck repair table pardata.appnexus_map_browser"
hive -e "drop table pardata.appnexus_map_carrier"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_carrier( id string, name string, country_code string, country_name string, codes string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_carrier'"
hive -e "msck repair table pardata.appnexus_map_carrier"
hive -e "drop table pardata.appnexus_map_device"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_device( id string, name string, device_make_id string, device_type string, screen_width string, screen_height string, supports_js string, supports_cookies string, supports_flash string, supports_geo string, supports_html_video string, supports_html_audio string, device_make_name string, codes string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_device'"
hive -e "msck repair table pardata.appnexus_map_device"
hive -e "drop table pardata.appnexus_map_dma"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_dma( id string, name string, code string, country_id string, country_name string, country_code string, active string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_dma'"
hive -e "msck repair table pardata.appnexus_map_dma"
hive -e "drop table pardata.appnexus_map_lang"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_lang( id string, name string, code string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_lang'"
hive -e "msck repair table pardata.appnexus_map_lang"
hive -e "drop table pardata.appnexus_map_mobileapp"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_mobileapp( id string, inventory_url_id string, mobile_app_store string, instance_bundle string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_mobileapp'"
hive -e "msck repair table pardata.appnexus_map_mobileapp"
hive -e "drop table pardata.appnexus_map_os"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_os( id string, name string, search_string string, family_id string, family_name string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_os'"
hive -e "msck repair table pardata.appnexus_map_os"
hive -e "drop table pardata.appnexus_map_publisher"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_map_publisher( id string, name string, code string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_map_publisher'"
hive -e "msck repair table pardata.appnexus_map_publisher"
hive -e "drop table pardata.appnexus_standard_feed"
hive -e "CREATE EXTERNAL TABLE pardata.appnexus_standard_feed( auction_id_64 bigint, datetime timestamp, user_tz_offset tinyint, width smallint, height smallint, media_type tinyint, fold_position tinyint, event_type string, imp_type tinyint, payment_type tinyint, media_cost_dollars_cpm double, revenue_type tinyint, buyer_spend double, buyer_bid double, ecp double, eap double, is_imp int, is_learn tinyint, predict_type_rev tinyint, user_id_64 bigint, ip_address string, ip_address_trunc string, geo_country string, geo_region string, operating_system tinyint, browser tinyint, language tinyint, venue_id int, seller_member_id int, publisher_id int, site_id int, site_domain string, tag_id int, external_inv_id int, reserve_price double, seller_revenue_cpm double, media_buy_rev_share_pct double, pub_rule_id int, seller_currency string, publisher_currency string, publisher_exchange_rate double, serving_fees_cpm double, serving_fees_revshare double, buyer_member_id int, advertiser_id int, brand_id int, advertiser_frequency int, advertiser_recency int, insertion_order_id int, campaign_group_id int, campaign_id int, creative_id int, creative_freq int, creative_rec int, cadence_modifier double, can_convert tinyint, user_group_id int, is_control tinyint, controller_pct double, controller_creative_pct int, is_click int, pixel_id int, is_remarketing tinyint, post_click_conv int, post_view_conv int, post_click_revenue double, post_view_revenue double, order_id string, external_data string, pricing_type string, booked_revenue_dollars double, booked_revenue_adv_curr double, commission_cpm double, commission_revshare double, auction_service_deduction double, auction_service_fees double, creative_overage_fees double, clear_fees double, buyer_currency string, advertiser_currency string, advertiser_exchange_rate double, latitude string, longitude string, device_unique_id string, device_id int, carrier_id int, deal_id int, view_result smallint, application_id string, supply_type smallint, sdk_version string, ozone_id int, billing_period_id int, view_non_measurable_reason int, external_uid string, request_uuid string, geo_dma int, geo_city int, mobile_app_instance_id int, traffic_source_code string, external_request_id string, deal_type int, ym_floor_id int, ym_bias_id int, is_filtered_request int, age int, gender string, is_exclusive int, bid_priority int, custom_model_id int, custom_model_last_modified int, leaf_name string, data_costs_cpm double) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/AppNexus/appnexus_standard_feed'"
hive -e "msck repair table pardata.appnexus_standard_feed"
hive -e "drop table pardata.appsflyer_inapp_events"
hive -e "CREATE EXTERNAL TABLE pardata.appsflyer_inapp_events( attributed_touch_type string, attributed_touch_time string, install_time string, event_time string, event_name string, event_value string, event_revenue string, event_revenue_currency string, event_revenue_usd string, event_source string, is_receipt_validated string, partner string, media_source string, channel string, keywords string, campaign string, campaign_id string, adset string, adset_id string, ad string, ad_id string, ad_type string, site_id string, sub_site_id string, sub_param_1 string, sub_param_2 string, sub_param_3 string, sub_param_4 string, sub_param_5 string, cost_model string, cost_value string, cost_currency string, contributor_1_partner string, contributor_1_media_source string, contributor_1_campaign string, contributor_1_touch_type string, contributor_1_touch_time string, contributor_2_partner string, contributor_2_media_source string, contributor_2_campaign string, contributor_2_touch_type string, contributor_2_touch_time string, contributor_3_partner string, contributor_3_media_source string, contributor_3_campaign string, contributor_3_touch_type string, contributor_3_touch_time string, region string, country_code string, state string, city string, postal_code string, dma string, ip string, wifi string, operator string, carrier string, language string, appsflyer_id string, advertising_id string, idfa string, android_id string, customer_user_id string, imei string, idfv string, platform string, device_type string, os_version string, app_version string, sdk_version string, app_id string, app_name string, bundle_id string, is_retargeting string, retargeting_conversion_type string, attribution_lookback string, reengagement_window string, is_primary_attribution string, user_agent string, http_referrer string, original_url string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/appsflyer_inapp_events'"
hive -e "msck repair table pardata.appsflyer_inapp_events"
hive -e "drop table pardata.appsflyer_installs"
hive -e "CREATE EXTERNAL TABLE pardata.appsflyer_installs( attributed_touch_type string, attributed_touch_time string, install_time string, event_time string, event_name string, event_value string, event_revenue string, event_revenue_currency string, event_revenue_usd string, event_source string, is_receipt_validated string, partner string, media_source string, channel string, keywords string, campaign string, campaign_id string, adset string, adset_id string, ad string, ad_id string, ad_type string, site_id string, sub_site_id string, sub_param_1 string, sub_param_2 string, sub_param_3 string, sub_param_4 string, sub_param_5 string, cost_model string, cost_value string, cost_currency string, contributor_1_partner string, contributor_1_media_source string, contributor_1_campaign string, contributor_1_touch_type string, contributor_1_touch_time string, contributor_2_partner string, contributor_2_media_source string, contributor_2_campaign string, contributor_2_touch_type string, contributor_2_touch_time string, contributor_3_partner string, contributor_3_media_source string, contributor_3_campaign string, contributor_3_touch_type string, contributor_3_touch_time string, region string, country_code string, state string, city string, postal_code string, dma string, ip string, wifi string, operator string, carrier string, language string, appsflyer_id string, advertising_id string, idfa string, android_id string, customer_user_id string, imei string, idfv string, platform string, device_type string, os_version string, app_version string, sdk_version string, app_id string, app_name string, bundle_id string, is_retargeting string, retargeting_conversion_type string, attribution_lookback string, reengagement_window string, is_primary_attribution string, user_agent string, http_referrer string, original_url string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/appsflyer_installs'"
hive -e "msck repair table pardata.appsflyer_installs"
hive -e "drop table pardata.tune_clicks_origin"
hive -e "CREATE EXTERNAL TABLE pardata.tune_clicks_origin( some_id string COMMENT 'from deserializer', advertiser_file_id string COMMENT 'from deserializer', advertiser_id string COMMENT 'from deserializer', advertiser_opt_out string COMMENT 'from deserializer', advertiser_sub_ad_id string COMMENT 'from deserializer', advertiser_sub_adgroup_id string COMMENT 'from deserializer', advertiser_sub_campaign_id string COMMENT 'from deserializer', advertiser_sub_keyword_id string COMMENT 'from deserializer', advertiser_sub_placement_id string COMMENT 'from deserializer', advertiser_sub_publisher_id string COMMENT 'from deserializer', advertiser_sub_site_id string COMMENT 'from deserializer', campaign_ad_id string COMMENT 'from deserializer', city_code string COMMENT 'from deserializer', content_id string COMMENT 'from deserializer', content_type string COMMENT 'from deserializer', created string COMMENT 'from deserializer', currency_code string COMMENT 'from deserializer', debug_mode string COMMENT 'from deserializer', device_id string COMMENT 'from deserializer', device_id_md5 string COMMENT 'from deserializer', device_id_sha1 string COMMENT 'from deserializer', device_id_sha256 string COMMENT 'from deserializer', device_ip string COMMENT 'from deserializer', device_type string COMMENT 'from deserializer', fb_user_id string COMMENT 'from deserializer', google_aid string COMMENT 'from deserializer', google_aid_md5 string COMMENT 'from deserializer', google_aid_sha1 string COMMENT 'from deserializer', google_aid_sha256 string COMMENT 'from deserializer', google_user_id string COMMENT 'from deserializer', id string COMMENT 'from deserializer', ios_ifa string COMMENT 'from deserializer', ios_ifa_md5 string COMMENT 'from deserializer', ios_ifa_sha1 string COMMENT 'from deserializer', ios_ifa_sha256 string COMMENT 'from deserializer', ios_ifv string COMMENT 'from deserializer', ios_ifv_md5 string COMMENT 'from deserializer', ios_ifv_sha1 string COMMENT 'from deserializer', ip string COMMENT 'from deserializer', is_unique string COMMENT 'from deserializer', mac_address string COMMENT 'from deserializer', mac_address_md5 string COMMENT 'from deserializer', mac_address_sha1 string COMMENT 'from deserializer', mat_id string COMMENT 'from deserializer', metro_code string COMMENT 'from deserializer', odin string COMMENT 'from deserializer', os_id string COMMENT 'from deserializer', os_id_md5 string COMMENT 'from deserializer', os_id_sha1 string COMMENT 'from deserializer', os_id_sha256 string COMMENT 'from deserializer', payout string COMMENT 'from deserializer', postal_code string COMMENT 'from deserializer', publisher_adgroup_id string COMMENT 'from deserializer', publisher_adgroup_item_id string COMMENT 'from deserializer', publisher_click_id string COMMENT 'from deserializer', publisher_ref_id string COMMENT 'from deserializer', publisher_sub1 string COMMENT 'from deserializer', publisher_sub2 string COMMENT 'from deserializer', publisher_sub3 string COMMENT 'from deserializer', publisher_sub4 string COMMENT 'from deserializer', publisher_sub5 string COMMENT 'from deserializer', publisher_sub_ad_id string COMMENT 'from deserializer', publisher_sub_adgroup_id string COMMENT 'from deserializer', publisher_sub_campaign_id string COMMENT 'from deserializer', publisher_sub_keyword_id string COMMENT 'from deserializer', publisher_sub_placement_id string COMMENT 'from deserializer', publisher_sub_publisher_id string COMMENT 'from deserializer', publisher_sub_site_id string COMMENT 'from deserializer', referral_url string COMMENT 'from deserializer', request_url string COMMENT 'from deserializer', revenue string COMMENT 'from deserializer', revenue_usd string COMMENT 'from deserializer', site_offset string COMMENT 'from deserializer', status string COMMENT 'from deserializer', status_code string COMMENT 'from deserializer', test_profile_id string COMMENT 'from deserializer', tracking_id string COMMENT 'from deserializer', transaction_id string COMMENT 'from deserializer', twitter_user_id string COMMENT 'from deserializer', unid string COMMENT 'from deserializer', unique_partner string COMMENT 'from deserializer', user_agent string COMMENT 'from deserializer', user_email string COMMENT 'from deserializer', user_email_md5 string COMMENT 'from deserializer', user_email_sha1 string COMMENT 'from deserializer', user_id string COMMENT 'from deserializer', user_id_md5 string COMMENT 'from deserializer', user_id_sha1 string COMMENT 'from deserializer', username string COMMENT 'from deserializer', username_md5 string COMMENT 'from deserializer', username_sha1 string COMMENT 'from deserializer', windows_aid string COMMENT 'from deserializer', windows_aid_md5 string COMMENT 'from deserializer', windows_aid_sha1 string COMMENT 'from deserializer', windows_aid_sha256 string COMMENT 'from deserializer', wurfl_brand_name string COMMENT 'from deserializer', wurfl_device_os string COMMENT 'from deserializer', wurfl_device_os_version string COMMENT 'from deserializer', wurfl_model_name string COMMENT 'from deserializer', ad_network_ad_formats string COMMENT 'from deserializer', ad_network_attribution_impression_view_percent string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', ad_network_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', ad_network_category string COMMENT 'from deserializer', ad_network_certified_partner string COMMENT 'from deserializer', ad_network_created string COMMENT 'from deserializer', ad_network_description string COMMENT 'from deserializer', ad_network_facebook_attribution_string string COMMENT 'from deserializer', ad_network_google_play_attribution_string string COMMENT 'from deserializer', ad_network_id string COMMENT 'from deserializer', ad_network_instructions_url string COMMENT 'from deserializer', ad_network_internal string COMMENT 'from deserializer', ad_network_modified string COMMENT 'from deserializer', ad_network_name string COMMENT 'from deserializer', ad_network_os_type string COMMENT 'from deserializer', ad_network_partner_type string COMMENT 'from deserializer', ad_network_reengagement_window_seconds string COMMENT 'from deserializer', ad_network_signup_url string COMMENT 'from deserializer', ad_network_status string COMMENT 'from deserializer', ad_network_supports_simplified string COMMENT 'from deserializer', ad_network_thumbnail_url string COMMENT 'from deserializer', ad_network_twitter_attribution_string string COMMENT 'from deserializer', ad_network_type string COMMENT 'from deserializer', agency_account_id string COMMENT 'from deserializer', agency_contact_email string COMMENT 'from deserializer', agency_contact_name string COMMENT 'from deserializer', agency_contact_phone string COMMENT 'from deserializer', agency_created string COMMENT 'from deserializer', agency_description string COMMENT 'from deserializer', agency_id string COMMENT 'from deserializer', agency_logo_url string COMMENT 'from deserializer', agency_logo_url_https string COMMENT 'from deserializer', agency_media_regions string COMMENT 'from deserializer', agency_modified string COMMENT 'from deserializer', agency_name string COMMENT 'from deserializer', agency_primary_contact_user_id string COMMENT 'from deserializer', agency_region_id string COMMENT 'from deserializer', agency_site_count string COMMENT 'from deserializer', agency_status string COMMENT 'from deserializer', agency_token string COMMENT 'from deserializer', agency_website string COMMENT 'from deserializer', campaign_allow_deep_links string COMMENT 'from deserializer', campaign_approve_conversions string COMMENT 'from deserializer', campaign_composit_ranking string COMMENT 'from deserializer', campaign_conversions_ranking string COMMENT 'from deserializer', campaign_created string COMMENT 'from deserializer', campaign_description string COMMENT 'from deserializer', campaign_epc_ranking string COMMENT 'from deserializer', campaign_expiration_date string COMMENT 'from deserializer', campaign_id string COMMENT 'from deserializer', campaign_incentivizable string COMMENT 'from deserializer', campaign_is_default string COMMENT 'from deserializer', campaign_modified string COMMENT 'from deserializer', campaign_name string COMMENT 'from deserializer', campaign_payout_ranking string COMMENT 'from deserializer', campaign_preview_url string COMMENT 'from deserializer', campaign_publisher_ranking string COMMENT 'from deserializer', campaign_ranking string COMMENT 'from deserializer', campaign_require_approval string COMMENT 'from deserializer', campaign_show_to_publishers string COMMENT 'from deserializer', campaign_site_id string COMMENT 'from deserializer', campaign_start_date string COMMENT 'from deserializer', campaign_status string COMMENT 'from deserializer', campaign_terms_and_conditions string COMMENT 'from deserializer', campaign_thumbnail_file_id string COMMENT 'from deserializer', campaign_vote_score string COMMENT 'from deserializer', campaign_url_campaign_id string COMMENT 'from deserializer', campaign_url_created string COMMENT 'from deserializer', campaign_url_custom_variables string COMMENT 'from deserializer', campaign_url_id string COMMENT 'from deserializer', campaign_url_is_default string COMMENT 'from deserializer', campaign_url_language_id string COMMENT 'from deserializer', campaign_url_modified string COMMENT 'from deserializer', campaign_url_name string COMMENT 'from deserializer', campaign_url_preview_url string COMMENT 'from deserializer', campaign_url_status string COMMENT 'from deserializer', campaign_url_thumbnail_file_id string COMMENT 'from deserializer', campaign_url_url string COMMENT 'from deserializer', country_code string COMMENT 'from deserializer', country_created string COMMENT 'from deserializer', country_id string COMMENT 'from deserializer', country_name string COMMENT 'from deserializer', publisher_account_id string COMMENT 'from deserializer', publisher_ad_network_id string COMMENT 'from deserializer', publisher_attribution_impression_view_percent string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', publisher_facebook_attribution_string string COMMENT 'from deserializer', publisher_google_play_attribution_string string COMMENT 'from deserializer', publisher_id string COMMENT 'from deserializer', publisher_internal string COMMENT 'from deserializer', publisher_name string COMMENT 'from deserializer', publisher_partner_type string COMMENT 'from deserializer', publisher_ranking string COMMENT 'from deserializer', publisher_reengagement_window_seconds string COMMENT 'from deserializer', publisher_status string COMMENT 'from deserializer', publisher_twitter_attribution_string string COMMENT 'from deserializer', publisher_votes string COMMENT 'from deserializer', region_code string COMMENT 'from deserializer', region_country_id string COMMENT 'from deserializer', region_created string COMMENT 'from deserializer', region_id string COMMENT 'from deserializer', region_name string COMMENT 'from deserializer', site_app_channel_id string COMMENT 'from deserializer', site_appsfigure_name string COMMENT 'from deserializer', site_conversion_key_id string COMMENT 'from deserializer', site_conversion_redirect_url string COMMENT 'from deserializer', site_created string COMMENT 'from deserializer', site_enable_web_tracking string COMMENT 'from deserializer', site_fb_app_id string COMMENT 'from deserializer', site_google_analytics string COMMENT 'from deserializer', site_id string COMMENT 'from deserializer', site_logo_url string COMMENT 'from deserializer', site_logo_url_https string COMMENT 'from deserializer', site_mobile_app_type string COMMENT 'from deserializer', site_modified string COMMENT 'from deserializer', site_name string COMMENT 'from deserializer', site_package_name string COMMENT 'from deserializer', site_ref_id string COMMENT 'from deserializer', site_status string COMMENT 'from deserializer', site_store_app_id string COMMENT 'from deserializer', site_ui_state string COMMENT 'from deserializer', site_url string COMMENT 'from deserializer') PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ( 'escapeChar'='\\', 'quoteChar'='\"', 'separatorChar'=',') STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/Tune/tune_clicks_origin'"
hive -e "msck repair table pardata.tune_clicks_origin"
hive -e "drop table pardata.tune_events_origin"
hive -e "CREATE EXTERNAL TABLE pardata.tune_events_origin( some_id string COMMENT 'from deserializer', advertiser_file_id string COMMENT 'from deserializer', advertiser_id string COMMENT 'from deserializer', advertiser_opt_out string COMMENT 'from deserializer', advertiser_ref_id string COMMENT 'from deserializer', advertiser_sub_ad_id string COMMENT 'from deserializer', advertiser_sub_adgroup_id string COMMENT 'from deserializer', advertiser_sub_campaign_id string COMMENT 'from deserializer', advertiser_sub_keyword_id string COMMENT 'from deserializer', advertiser_sub_placement_id string COMMENT 'from deserializer', advertiser_sub_publisher_id string COMMENT 'from deserializer', advertiser_sub_site_id string COMMENT 'from deserializer', age string COMMENT 'from deserializer', app_name string COMMENT 'from deserializer', app_version string COMMENT 'from deserializer', attribute_sub1 string COMMENT 'from deserializer', attribute_sub2 string COMMENT 'from deserializer', attribute_sub3 string COMMENT 'from deserializer', attribute_sub4 string COMMENT 'from deserializer', attribute_sub5 string COMMENT 'from deserializer', campaign_ad_id string COMMENT 'from deserializer', campaign_payout_id string COMMENT 'from deserializer', city_code string COMMENT 'from deserializer', content_id string COMMENT 'from deserializer', content_type string COMMENT 'from deserializer', created string COMMENT 'from deserializer', currency_code string COMMENT 'from deserializer', date1 string COMMENT 'from deserializer', date2 string COMMENT 'from deserializer', debug_mode string COMMENT 'from deserializer', device_brand string COMMENT 'from deserializer', device_carrier string COMMENT 'from deserializer', device_id string COMMENT 'from deserializer', device_id_md5 string COMMENT 'from deserializer', device_id_sha1 string COMMENT 'from deserializer', device_id_sha256 string COMMENT 'from deserializer', device_ip string COMMENT 'from deserializer', device_model string COMMENT 'from deserializer', device_type string COMMENT 'from deserializer', event_type string COMMENT 'from deserializer', existing_user string COMMENT 'from deserializer', fb_user_id string COMMENT 'from deserializer', gender string COMMENT 'from deserializer', google_aid string COMMENT 'from deserializer', google_aid_md5 string COMMENT 'from deserializer', google_aid_sha1 string COMMENT 'from deserializer', google_aid_sha256 string COMMENT 'from deserializer', google_user_id string COMMENT 'from deserializer', id string COMMENT 'from deserializer', impression_created string COMMENT 'from deserializer', install_created string COMMENT 'from deserializer', install_stat_click_id string COMMENT 'from deserializer', ios_ifa string COMMENT 'from deserializer', ios_ifa_md5 string COMMENT 'from deserializer', ios_ifa_sha1 string COMMENT 'from deserializer', ios_ifa_sha256 string COMMENT 'from deserializer', ios_ifv string COMMENT 'from deserializer', ios_ifv_md5 string COMMENT 'from deserializer', ios_ifv_sha1 string COMMENT 'from deserializer', ip string COMMENT 'from deserializer', is_reengagement string COMMENT 'from deserializer', is_view_through string COMMENT 'from deserializer', language string COMMENT 'from deserializer', latitude string COMMENT 'from deserializer', longitude string COMMENT 'from deserializer', level string COMMENT 'from deserializer', mac_address string COMMENT 'from deserializer', mac_address_md5 string COMMENT 'from deserializer', mac_address_sha1 string COMMENT 'from deserializer', mat_id string COMMENT 'from deserializer', match_type string COMMENT 'from deserializer', metro_code string COMMENT 'from deserializer', odin string COMMENT 'from deserializer', os_id string COMMENT 'from deserializer', os_id_md5 string COMMENT 'from deserializer', os_id_sha1 string COMMENT 'from deserializer', os_id_sha256 string COMMENT 'from deserializer', os_jailbroke string COMMENT 'from deserializer', os_version string COMMENT 'from deserializer', package_name string COMMENT 'from deserializer', payout string COMMENT 'from deserializer', postal_code string COMMENT 'from deserializer', publisher_adgroup_id string COMMENT 'from deserializer', publisher_adgroup_item_id string COMMENT 'from deserializer', publisher_click_id string COMMENT 'from deserializer', publisher_ref_id string COMMENT 'from deserializer', publisher_sub1 string COMMENT 'from deserializer', publisher_sub2 string COMMENT 'from deserializer', publisher_sub3 string COMMENT 'from deserializer', publisher_sub4 string COMMENT 'from deserializer', publisher_sub5 string COMMENT 'from deserializer', publisher_sub_ad_id string COMMENT 'from deserializer', publisher_sub_adgroup_id string COMMENT 'from deserializer', publisher_sub_campaign_id string COMMENT 'from deserializer', publisher_sub_keyword_id string COMMENT 'from deserializer', publisher_sub_placement_id string COMMENT 'from deserializer', publisher_sub_publisher_id string COMMENT 'from deserializer', publisher_sub_site_id string COMMENT 'from deserializer', purchase_validation_status string COMMENT 'from deserializer', quantity string COMMENT 'from deserializer', rating string COMMENT 'from deserializer', referral_source string COMMENT 'from deserializer', referral_url string COMMENT 'from deserializer', request_url string COMMENT 'from deserializer', revenue string COMMENT 'from deserializer', revenue_usd string COMMENT 'from deserializer', sdk string COMMENT 'from deserializer', sdk_version string COMMENT 'from deserializer', search_string string COMMENT 'from deserializer', session_datetime string COMMENT 'from deserializer', session_ip string COMMENT 'from deserializer', site_event_items_count string COMMENT 'from deserializer', stat_click_id string COMMENT 'from deserializer', stat_impression_id string COMMENT 'from deserializer', stat_install_id string COMMENT 'from deserializer', stat_update_id string COMMENT 'from deserializer', status string COMMENT 'from deserializer', status_code string COMMENT 'from deserializer', test_profile_id string COMMENT 'from deserializer', tracking_id string COMMENT 'from deserializer', transaction_id string COMMENT 'from deserializer', twitter_user_id string COMMENT 'from deserializer', unid string COMMENT 'from deserializer', unique_partner string COMMENT 'from deserializer', user_agent string COMMENT 'from deserializer', user_email string COMMENT 'from deserializer', user_email_md5 string COMMENT 'from deserializer', user_email_sha1 string COMMENT 'from deserializer', user_id string COMMENT 'from deserializer', user_id_md5 string COMMENT 'from deserializer', user_id_sha1 string COMMENT 'from deserializer', username string COMMENT 'from deserializer', username_md5 string COMMENT 'from deserializer', username_sha1 string COMMENT 'from deserializer', windows_aid string COMMENT 'from deserializer', windows_aid_md5 string COMMENT 'from deserializer', windows_aid_sha1 string COMMENT 'from deserializer', windows_aid_sha256 string COMMENT 'from deserializer', ad_network_ad_formats string COMMENT 'from deserializer', ad_network_attribution_impression_view_percent string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', ad_network_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', ad_network_category string COMMENT 'from deserializer', ad_network_certified_partner string COMMENT 'from deserializer', ad_network_created string COMMENT 'from deserializer', ad_network_description string COMMENT 'from deserializer', ad_network_facebook_attribution_string string COMMENT 'from deserializer', ad_network_google_play_attribution_string string COMMENT 'from deserializer', ad_network_id string COMMENT 'from deserializer', ad_network_instructions_url string COMMENT 'from deserializer', ad_network_internal string COMMENT 'from deserializer', ad_network_modified string COMMENT 'from deserializer', ad_network_name string COMMENT 'from deserializer', ad_network_os_type string COMMENT 'from deserializer', ad_network_partner_type string COMMENT 'from deserializer', ad_network_reengagement_window_seconds string COMMENT 'from deserializer', ad_network_signup_url string COMMENT 'from deserializer', ad_network_status string COMMENT 'from deserializer', ad_network_supports_simplified string COMMENT 'from deserializer', ad_network_thumbnail_url string COMMENT 'from deserializer', ad_network_twitter_attribution_string string COMMENT 'from deserializer', ad_network_type string COMMENT 'from deserializer', agency_account_id string COMMENT 'from deserializer', agency_contact_email string COMMENT 'from deserializer', agency_contact_name string COMMENT 'from deserializer', agency_contact_phone string COMMENT 'from deserializer', agency_created string COMMENT 'from deserializer', agency_description string COMMENT 'from deserializer', agency_id string COMMENT 'from deserializer', agency_logo_url string COMMENT 'from deserializer', agency_logo_url_https string COMMENT 'from deserializer', agency_media_regions string COMMENT 'from deserializer', agency_modified string COMMENT 'from deserializer', agency_name string COMMENT 'from deserializer', agency_primary_contact_user_id string COMMENT 'from deserializer', agency_region_id string COMMENT 'from deserializer', agency_site_count string COMMENT 'from deserializer', agency_status string COMMENT 'from deserializer', agency_token string COMMENT 'from deserializer', agency_website string COMMENT 'from deserializer', campaign_url_campaign_id string COMMENT 'from deserializer', campaign_url_created string COMMENT 'from deserializer', campaign_url_custom_variables string COMMENT 'from deserializer', campaign_url_id string COMMENT 'from deserializer', campaign_url_is_default string COMMENT 'from deserializer', campaign_url_language_id string COMMENT 'from deserializer', campaign_url_modified string COMMENT 'from deserializer', campaign_url_name string COMMENT 'from deserializer', campaign_url_preview_url string COMMENT 'from deserializer', campaign_url_status string COMMENT 'from deserializer', campaign_url_thumbnail_file_id string COMMENT 'from deserializer', campaign_url_url string COMMENT 'from deserializer', campaign_allow_deep_links string COMMENT 'from deserializer', campaign_approve_conversions string COMMENT 'from deserializer', campaign_composit_ranking string COMMENT 'from deserializer', campaign_conversions_ranking string COMMENT 'from deserializer', campaign_created string COMMENT 'from deserializer', campaign_description string COMMENT 'from deserializer', campaign_epc_ranking string COMMENT 'from deserializer', campaign_expiration_date string COMMENT 'from deserializer', campaign_id string COMMENT 'from deserializer', campaign_incentivizable string COMMENT 'from deserializer', campaign_is_default string COMMENT 'from deserializer', campaign_modified string COMMENT 'from deserializer', campaign_name string COMMENT 'from deserializer', campaign_payout_ranking string COMMENT 'from deserializer', campaign_preview_url string COMMENT 'from deserializer', campaign_publisher_ranking string COMMENT 'from deserializer', campaign_ranking string COMMENT 'from deserializer', campaign_require_approval string COMMENT 'from deserializer', campaign_show_to_publishers string COMMENT 'from deserializer', campaign_site_id string COMMENT 'from deserializer', campaign_start_date string COMMENT 'from deserializer', campaign_status string COMMENT 'from deserializer', campaign_terms_and_conditions string COMMENT 'from deserializer', campaign_thumbnail_file_id string COMMENT 'from deserializer', campaign_vote_score string COMMENT 'from deserializer', country_code string COMMENT 'from deserializer', country_created string COMMENT 'from deserializer', country_id string COMMENT 'from deserializer', country_name string COMMENT 'from deserializer', install_publisher_account_id string COMMENT 'from deserializer', install_publisher_ad_network_id string COMMENT 'from deserializer', install_publisher_attribution_impression_view_percent string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', install_publisher_facebook_attribution_string string COMMENT 'from deserializer', install_publisher_google_play_attribution_string string COMMENT 'from deserializer', install_publisher_id string COMMENT 'from deserializer', install_publisher_internal string COMMENT 'from deserializer', install_publisher_name string COMMENT 'from deserializer', install_publisher_partner_type string COMMENT 'from deserializer', install_publisher_ranking string COMMENT 'from deserializer', install_publisher_reengagement_window_seconds string COMMENT 'from deserializer', install_publisher_status string COMMENT 'from deserializer', install_publisher_twitter_attribution_string string COMMENT 'from deserializer', install_publisher_votes string COMMENT 'from deserializer', publisher_account_id string COMMENT 'from deserializer', publisher_ad_network_id string COMMENT 'from deserializer', publisher_attribution_impression_view_percent string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', publisher_facebook_attribution_string string COMMENT 'from deserializer', publisher_google_play_attribution_string string COMMENT 'from deserializer', publisher_id string COMMENT 'from deserializer', publisher_internal string COMMENT 'from deserializer', publisher_name string COMMENT 'from deserializer', publisher_partner_type string COMMENT 'from deserializer', publisher_ranking string COMMENT 'from deserializer', publisher_reengagement_window_seconds string COMMENT 'from deserializer', publisher_status string COMMENT 'from deserializer', publisher_twitter_attribution_string string COMMENT 'from deserializer', publisher_votes string COMMENT 'from deserializer', region_code string COMMENT 'from deserializer', region_country_id string COMMENT 'from deserializer', region_created string COMMENT 'from deserializer', region_id string COMMENT 'from deserializer', region_name string COMMENT 'from deserializer', site_event_aggregate_revenue string COMMENT 'from deserializer', site_event_created string COMMENT 'from deserializer', site_event_id string COMMENT 'from deserializer', site_event_modified string COMMENT 'from deserializer', site_event_name string COMMENT 'from deserializer', site_event_reengagement_tracking_enabled string COMMENT 'from deserializer', site_event_ref string COMMENT 'from deserializer', site_event_site_id string COMMENT 'from deserializer', site_event_status string COMMENT 'from deserializer', site_event_tracking_type string COMMENT 'from deserializer', site_event_tracking_verified string COMMENT 'from deserializer', site_event_type string COMMENT 'from deserializer', site_app_channel_id string COMMENT 'from deserializer', site_appsfigure_name string COMMENT 'from deserializer', site_conversion_key_id string COMMENT 'from deserializer', site_conversion_redirect_url string COMMENT 'from deserializer', site_created string COMMENT 'from deserializer', site_enable_web_tracking string COMMENT 'from deserializer', site_fb_app_id string COMMENT 'from deserializer', site_google_analytics string COMMENT 'from deserializer', site_id string COMMENT 'from deserializer', site_logo_url string COMMENT 'from deserializer', site_logo_url_https string COMMENT 'from deserializer', site_mobile_app_type string COMMENT 'from deserializer', site_modified string COMMENT 'from deserializer', site_name string COMMENT 'from deserializer', site_package_name string COMMENT 'from deserializer', site_ref_id string COMMENT 'from deserializer', site_status string COMMENT 'from deserializer', site_store_app_id string COMMENT 'from deserializer', site_ui_state string COMMENT 'from deserializer', site_url string COMMENT 'from deserializer') PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ( 'escapeChar'='\\', 'quoteChar'='\"', 'separatorChar'=',') STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/Tune/tune_events_origin'"
hive -e "msck repair table pardata.tune_events_origin"
hive -e "drop table pardata.tune_installs_origin"
hive -e "CREATE EXTERNAL TABLE pardata.tune_installs_origin( some_id string COMMENT 'from deserializer', advertiser_file_id string COMMENT 'from deserializer', advertiser_id string COMMENT 'from deserializer', advertiser_opt_out string COMMENT 'from deserializer', advertiser_ref_id string COMMENT 'from deserializer', advertiser_sub_ad_id string COMMENT 'from deserializer', advertiser_sub_adgroup_id string COMMENT 'from deserializer', advertiser_sub_campaign_id string COMMENT 'from deserializer', advertiser_sub_keyword_id string COMMENT 'from deserializer', advertiser_sub_placement_id string COMMENT 'from deserializer', advertiser_sub_publisher_id string COMMENT 'from deserializer', advertiser_sub_site_id string COMMENT 'from deserializer', age string COMMENT 'from deserializer', altitude string COMMENT 'from deserializer', app_name string COMMENT 'from deserializer', app_version string COMMENT 'from deserializer', attribute_sub1 string COMMENT 'from deserializer', attribute_sub2 string COMMENT 'from deserializer', attribute_sub3 string COMMENT 'from deserializer', attribute_sub4 string COMMENT 'from deserializer', attribute_sub5 string COMMENT 'from deserializer', campaign_ad_id string COMMENT 'from deserializer', campaign_payout_id string COMMENT 'from deserializer', city_code string COMMENT 'from deserializer', click_gross_count string COMMENT 'from deserializer', click_publishers_count string COMMENT 'from deserializer', click_unique_count string COMMENT 'from deserializer', created string COMMENT 'from deserializer', currency_code string COMMENT 'from deserializer', debug_mode string COMMENT 'from deserializer', device_brand string COMMENT 'from deserializer', device_carrier string COMMENT 'from deserializer', device_id string COMMENT 'from deserializer', device_id_md5 string COMMENT 'from deserializer', device_id_sha1 string COMMENT 'from deserializer', device_id_sha256 string COMMENT 'from deserializer', device_ip string COMMENT 'from deserializer', device_model string COMMENT 'from deserializer', device_type string COMMENT 'from deserializer', existing_user string COMMENT 'from deserializer', fb_user_id string COMMENT 'from deserializer', gender string COMMENT 'from deserializer', google_aid string COMMENT 'from deserializer', google_aid_md5 string COMMENT 'from deserializer', google_aid_sha1 string COMMENT 'from deserializer', google_aid_sha256 string COMMENT 'from deserializer', google_user_id string COMMENT 'from deserializer', id string COMMENT 'from deserializer', impression_created string COMMENT 'from deserializer', impression_gross_count string COMMENT 'from deserializer', impression_publishers_count string COMMENT 'from deserializer', impression_unique_count string COMMENT 'from deserializer', ios_ifa string COMMENT 'from deserializer', ios_ifa_md5 string COMMENT 'from deserializer', ios_ifa_sha1 string COMMENT 'from deserializer', ios_ifa_sha256 string COMMENT 'from deserializer', ios_ifv string COMMENT 'from deserializer', ios_ifv_md5 string COMMENT 'from deserializer', ios_ifv_sha1 string COMMENT 'from deserializer', ip string COMMENT 'from deserializer', is_view_through string COMMENT 'from deserializer', language string COMMENT 'from deserializer', latitude string COMMENT 'from deserializer', longitude string COMMENT 'from deserializer', mac_address string COMMENT 'from deserializer', mac_address_md5 string COMMENT 'from deserializer', mac_address_sha1 string COMMENT 'from deserializer', mat_id string COMMENT 'from deserializer', match_type string COMMENT 'from deserializer', metro_code string COMMENT 'from deserializer', odin string COMMENT 'from deserializer', os_id string COMMENT 'from deserializer', os_id_md5 string COMMENT 'from deserializer', os_id_sha1 string COMMENT 'from deserializer', os_id_sha256 string COMMENT 'from deserializer', os_jailbroke string COMMENT 'from deserializer', os_version string COMMENT 'from deserializer', package_name string COMMENT 'from deserializer', payout string COMMENT 'from deserializer', postal_code string COMMENT 'from deserializer', publisher_adgroup_id string COMMENT 'from deserializer', publisher_adgroup_item_id string COMMENT 'from deserializer', publisher_click_id string COMMENT 'from deserializer', publisher_ref_id string COMMENT 'from deserializer', publisher_sub1 string COMMENT 'from deserializer', publisher_sub2 string COMMENT 'from deserializer', publisher_sub3 string COMMENT 'from deserializer', publisher_sub4 string COMMENT 'from deserializer', publisher_sub5 string COMMENT 'from deserializer', publisher_sub_ad_id string COMMENT 'from deserializer', publisher_sub_adgroup_id string COMMENT 'from deserializer', publisher_sub_campaign_id string COMMENT 'from deserializer', publisher_sub_keyword_id string COMMENT 'from deserializer', publisher_sub_placement_id string COMMENT 'from deserializer', publisher_sub_publisher_id string COMMENT 'from deserializer', publisher_sub_site_id string COMMENT 'from deserializer', referral_source string COMMENT 'from deserializer', referral_url string COMMENT 'from deserializer', request_url string COMMENT 'from deserializer', revenue string COMMENT 'from deserializer', revenue_usd string COMMENT 'from deserializer', sdk string COMMENT 'from deserializer', sdk_version string COMMENT 'from deserializer', session_datetime string COMMENT 'from deserializer', session_ip string COMMENT 'from deserializer', stat_click_id string COMMENT 'from deserializer', stat_impression_id string COMMENT 'from deserializer', status string COMMENT 'from deserializer', status_code string COMMENT 'from deserializer', test_profile_id string COMMENT 'from deserializer', tracking_id string COMMENT 'from deserializer', transaction_id string COMMENT 'from deserializer', twitter_user_id string COMMENT 'from deserializer', unid string COMMENT 'from deserializer', unique_partner string COMMENT 'from deserializer', user_agent string COMMENT 'from deserializer', user_email string COMMENT 'from deserializer', user_email_md5 string COMMENT 'from deserializer', user_email_sha1 string COMMENT 'from deserializer', user_id string COMMENT 'from deserializer', user_id_md5 string COMMENT 'from deserializer', user_id_sha1 string COMMENT 'from deserializer', username string COMMENT 'from deserializer', username_md5 string COMMENT 'from deserializer', username_sha1 string COMMENT 'from deserializer', windows_aid string COMMENT 'from deserializer', windows_aid_md5 string COMMENT 'from deserializer', windows_aid_sha1 string COMMENT 'from deserializer', windows_aid_sha256 string COMMENT 'from deserializer', ad_network_ad_formats string COMMENT 'from deserializer', ad_network_attribution_impression_view_percent string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', ad_network_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', ad_network_category string COMMENT 'from deserializer', ad_network_certified_partner string COMMENT 'from deserializer', ad_network_created string COMMENT 'from deserializer', ad_network_description string COMMENT 'from deserializer', ad_network_facebook_attribution_string string COMMENT 'from deserializer', ad_network_google_play_attribution_string string COMMENT 'from deserializer', ad_network_id string COMMENT 'from deserializer', ad_network_instructions_url string COMMENT 'from deserializer', ad_network_internal string COMMENT 'from deserializer', ad_network_modified string COMMENT 'from deserializer', ad_network_name string COMMENT 'from deserializer', ad_network_os_type string COMMENT 'from deserializer', ad_network_partner_type string COMMENT 'from deserializer', ad_network_reengagement_window_seconds string COMMENT 'from deserializer', ad_network_signup_url string COMMENT 'from deserializer', ad_network_status string COMMENT 'from deserializer', ad_network_supports_simplified string COMMENT 'from deserializer', ad_network_thumbnail_url string COMMENT 'from deserializer', ad_network_twitter_attribution_string string COMMENT 'from deserializer', ad_network_type string COMMENT 'from deserializer', agency_account_id string COMMENT 'from deserializer', agency_contact_email string COMMENT 'from deserializer', agency_contact_name string COMMENT 'from deserializer', agency_contact_phone string COMMENT 'from deserializer', agency_created string COMMENT 'from deserializer', agency_description string COMMENT 'from deserializer', agency_id string COMMENT 'from deserializer', agency_logo_url string COMMENT 'from deserializer', agency_logo_url_https string COMMENT 'from deserializer', agency_media_regions string COMMENT 'from deserializer', agency_modified string COMMENT 'from deserializer', agency_name string COMMENT 'from deserializer', agency_primary_contact_user_id string COMMENT 'from deserializer', agency_region_id string COMMENT 'from deserializer', agency_site_count string COMMENT 'from deserializer', agency_status string COMMENT 'from deserializer', agency_token string COMMENT 'from deserializer', agency_website string COMMENT 'from deserializer', campaign_allow_deep_links string COMMENT 'from deserializer', campaign_approve_conversions string COMMENT 'from deserializer', campaign_composit_ranking string COMMENT 'from deserializer', campaign_conversions_ranking string COMMENT 'from deserializer', campaign_created string COMMENT 'from deserializer', campaign_description string COMMENT 'from deserializer', campaign_epc_ranking string COMMENT 'from deserializer', campaign_expiration_date string COMMENT 'from deserializer', campaign_id string COMMENT 'from deserializer', campaign_incentivizable string COMMENT 'from deserializer', campaign_is_default string COMMENT 'from deserializer', campaign_modified string COMMENT 'from deserializer', campaign_name string COMMENT 'from deserializer', campaign_payout_ranking string COMMENT 'from deserializer', campaign_preview_url string COMMENT 'from deserializer', campaign_publisher_ranking string COMMENT 'from deserializer', campaign_ranking string COMMENT 'from deserializer', campaign_require_approval string COMMENT 'from deserializer', campaign_show_to_publishers string COMMENT 'from deserializer', campaign_site_id string COMMENT 'from deserializer', campaign_start_date string COMMENT 'from deserializer', campaign_status string COMMENT 'from deserializer', campaign_terms_and_conditions string COMMENT 'from deserializer', campaign_thumbnail_file_id string COMMENT 'from deserializer', campaign_vote_score string COMMENT 'from deserializer', campaign_url_campaign_id string COMMENT 'from deserializer', campaign_url_created string COMMENT 'from deserializer', campaign_url_custom_variables string COMMENT 'from deserializer', campaign_url_id string COMMENT 'from deserializer', campaign_url_is_default string COMMENT 'from deserializer', campaign_url_language_id string COMMENT 'from deserializer', campaign_url_modified string COMMENT 'from deserializer', campaign_url_name string COMMENT 'from deserializer', campaign_url_preview_url string COMMENT 'from deserializer', campaign_url_status string COMMENT 'from deserializer', campaign_url_thumbnail_file_id string COMMENT 'from deserializer', campaign_url_url string COMMENT 'from deserializer', country_code string COMMENT 'from deserializer', country_created string COMMENT 'from deserializer', country_id string COMMENT 'from deserializer', country_name string COMMENT 'from deserializer', publisher_account_id string COMMENT 'from deserializer', publisher_ad_network_id string COMMENT 'from deserializer', publisher_attribution_impression_view_percent string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', publisher_facebook_attribution_string string COMMENT 'from deserializer', publisher_google_play_attribution_string string COMMENT 'from deserializer', publisher_id string COMMENT 'from deserializer', publisher_internal string COMMENT 'from deserializer', publisher_name string COMMENT 'from deserializer', publisher_partner_type string COMMENT 'from deserializer', publisher_ranking string COMMENT 'from deserializer', publisher_reengagement_window_seconds string COMMENT 'from deserializer', publisher_status string COMMENT 'from deserializer', publisher_twitter_attribution_string string COMMENT 'from deserializer', publisher_votes string COMMENT 'from deserializer', region_code string COMMENT 'from deserializer', region_country_id string COMMENT 'from deserializer', region_created string COMMENT 'from deserializer', region_id string COMMENT 'from deserializer', region_name string COMMENT 'from deserializer', site_event_aggregate_revenue string COMMENT 'from deserializer', site_event_created string COMMENT 'from deserializer', site_event_id string COMMENT 'from deserializer', site_event_modified string COMMENT 'from deserializer', site_event_name string COMMENT 'from deserializer', site_event_reengagement_tracking_enabled string COMMENT 'from deserializer', site_event_ref string COMMENT 'from deserializer', site_event_site_id string COMMENT 'from deserializer', site_event_status string COMMENT 'from deserializer', site_event_tracking_type string COMMENT 'from deserializer', site_event_tracking_verified string COMMENT 'from deserializer', site_event_type string COMMENT 'from deserializer', site_app_channel_id string COMMENT 'from deserializer', site_appsfigure_name string COMMENT 'from deserializer', site_conversion_key_id string COMMENT 'from deserializer', site_conversion_redirect_url string COMMENT 'from deserializer', site_created string COMMENT 'from deserializer', site_enable_web_tracking string COMMENT 'from deserializer', site_fb_app_id string COMMENT 'from deserializer', site_google_analytics string COMMENT 'from deserializer', site_id string COMMENT 'from deserializer', site_logo_url string COMMENT 'from deserializer', site_logo_url_https string COMMENT 'from deserializer', site_mobile_app_type string COMMENT 'from deserializer', site_modified string COMMENT 'from deserializer', site_name string COMMENT 'from deserializer', site_package_name string COMMENT 'from deserializer', site_ref_id string COMMENT 'from deserializer', site_status string COMMENT 'from deserializer', site_store_app_id string COMMENT 'from deserializer', site_ui_state string COMMENT 'from deserializer', site_url string COMMENT 'from deserializer') PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ( 'escapeChar'='\\', 'quoteChar'='\"', 'separatorChar'=',') STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/Tune/tune_installs_origin'"
hive -e "msck repair table pardata.tune_installs_origin"
hive -e "drop table pardata.tune_opens_origin"
hive -e "CREATE EXTERNAL TABLE pardata.tune_opens_origin( some_id string COMMENT 'from deserializer', advertiser_file_id string COMMENT 'from deserializer', advertiser_opt_out string COMMENT 'from deserializer', advertiser_ref_id string COMMENT 'from deserializer', advertiser_sub_ad_id string COMMENT 'from deserializer', advertiser_sub_adgroup_id string COMMENT 'from deserializer', advertiser_sub_campaign_id string COMMENT 'from deserializer', advertiser_sub_keyword_id string COMMENT 'from deserializer', advertiser_sub_placement_id string COMMENT 'from deserializer', advertiser_sub_publisher_id string COMMENT 'from deserializer', advertiser_sub_site_id string COMMENT 'from deserializer', age string COMMENT 'from deserializer', altitude string COMMENT 'from deserializer', app_name string COMMENT 'from deserializer', app_version string COMMENT 'from deserializer', attribute_sub1 string COMMENT 'from deserializer', attribute_sub2 string COMMENT 'from deserializer', attribute_sub3 string COMMENT 'from deserializer', attribute_sub4 string COMMENT 'from deserializer', attribute_sub5 string COMMENT 'from deserializer', campaign_ad_id string COMMENT 'from deserializer', campaign_payout_id string COMMENT 'from deserializer', city_code string COMMENT 'from deserializer', click_gross_count string COMMENT 'from deserializer', click_publishers_count string COMMENT 'from deserializer', click_unique_count string COMMENT 'from deserializer', created string COMMENT 'from deserializer', currency_code string COMMENT 'from deserializer', debug_mode string COMMENT 'from deserializer', device_brand string COMMENT 'from deserializer', device_carrier string COMMENT 'from deserializer', device_id string COMMENT 'from deserializer', device_id_md5 string COMMENT 'from deserializer', device_id_sha1 string COMMENT 'from deserializer', device_id_sha256 string COMMENT 'from deserializer', device_ip string COMMENT 'from deserializer', device_model string COMMENT 'from deserializer', device_type string COMMENT 'from deserializer', existing_user string COMMENT 'from deserializer', fb_user_id string COMMENT 'from deserializer', gender string COMMENT 'from deserializer', google_aid string COMMENT 'from deserializer', google_aid_md5 string COMMENT 'from deserializer', google_aid_sha1 string COMMENT 'from deserializer', google_aid_sha256 string COMMENT 'from deserializer', google_user_id string COMMENT 'from deserializer', id string COMMENT 'from deserializer', impression_created string COMMENT 'from deserializer', impression_gross_count string COMMENT 'from deserializer', impression_publishers_count string COMMENT 'from deserializer', impression_unique_count string COMMENT 'from deserializer', install_created string COMMENT 'from deserializer', install_date string COMMENT 'from deserializer', install_stat_click_id string COMMENT 'from deserializer', ios_ad_tracking string COMMENT 'from deserializer', ios_ifa string COMMENT 'from deserializer', ios_ifa_md5 string COMMENT 'from deserializer', ios_ifa_sha1 string COMMENT 'from deserializer', ios_ifa_sha256 string COMMENT 'from deserializer', ios_ifv string COMMENT 'from deserializer', ios_ifv_md5 string COMMENT 'from deserializer', ios_ifv_sha1 string COMMENT 'from deserializer', ip string COMMENT 'from deserializer', is_reengagement string COMMENT 'from deserializer', is_view_through string COMMENT 'from deserializer', language string COMMENT 'from deserializer', latitude string COMMENT 'from deserializer', longitude string COMMENT 'from deserializer', mac_address string COMMENT 'from deserializer', mac_address_md5 string COMMENT 'from deserializer', mac_address_sha1 string COMMENT 'from deserializer', mat_id string COMMENT 'from deserializer', match_type string COMMENT 'from deserializer', metro_code string COMMENT 'from deserializer', odin string COMMENT 'from deserializer', os_id string COMMENT 'from deserializer', os_id_md5 string COMMENT 'from deserializer', os_id_sha1 string COMMENT 'from deserializer', os_id_sha256 string COMMENT 'from deserializer', os_jailbroke string COMMENT 'from deserializer', os_version string COMMENT 'from deserializer', package_name string COMMENT 'from deserializer', payout string COMMENT 'from deserializer', postal_code string COMMENT 'from deserializer', publisher_adgroup_id string COMMENT 'from deserializer', publisher_adgroup_item_id string COMMENT 'from deserializer', publisher_click_id string COMMENT 'from deserializer', publisher_ref_id string COMMENT 'from deserializer', publisher_sub1 string COMMENT 'from deserializer', publisher_sub2 string COMMENT 'from deserializer', publisher_sub3 string COMMENT 'from deserializer', publisher_sub4 string COMMENT 'from deserializer', publisher_sub5 string COMMENT 'from deserializer', publisher_sub_ad_id string COMMENT 'from deserializer', publisher_sub_adgroup_id string COMMENT 'from deserializer', publisher_sub_campaign_id string COMMENT 'from deserializer', publisher_sub_keyword_id string COMMENT 'from deserializer', publisher_sub_placement_id string COMMENT 'from deserializer', publisher_sub_publisher_id string COMMENT 'from deserializer', publisher_sub_site_id string COMMENT 'from deserializer', referral_source string COMMENT 'from deserializer', referral_url string COMMENT 'from deserializer', request_url string COMMENT 'from deserializer', revenue string COMMENT 'from deserializer', revenue_usd string COMMENT 'from deserializer', sdk string COMMENT 'from deserializer', sdk_version string COMMENT 'from deserializer', session_datetime string COMMENT 'from deserializer', session_ip string COMMENT 'from deserializer', site_event_items_count string COMMENT 'from deserializer', stat_click_id string COMMENT 'from deserializer', stat_impression_id string COMMENT 'from deserializer', stat_install_id string COMMENT 'from deserializer', stat_update_id string COMMENT 'from deserializer', status string COMMENT 'from deserializer', status_code string COMMENT 'from deserializer', test_profile_id string COMMENT 'from deserializer', tracking_id string COMMENT 'from deserializer', transaction_id string COMMENT 'from deserializer', twitter_user_id string COMMENT 'from deserializer', unid string COMMENT 'from deserializer', unique_partner string COMMENT 'from deserializer', user_agent string COMMENT 'from deserializer', user_email string COMMENT 'from deserializer', user_email_md5 string COMMENT 'from deserializer', user_email_sha1 string COMMENT 'from deserializer', user_id string COMMENT 'from deserializer', user_id_md5 string COMMENT 'from deserializer', user_id_sha1 string COMMENT 'from deserializer', username string COMMENT 'from deserializer', username_md5 string COMMENT 'from deserializer', username_sha1 string COMMENT 'from deserializer', windows_aid string COMMENT 'from deserializer', windows_aid_md5 string COMMENT 'from deserializer', windows_aid_sha1 string COMMENT 'from deserializer', windows_aid_sha256 string COMMENT 'from deserializer', wurfl_brand_name string COMMENT 'from deserializer', wurfl_device_os string COMMENT 'from deserializer', wurfl_device_os_version string COMMENT 'from deserializer', wurfl_model_name string COMMENT 'from deserializer', ad_network_ad_formats string COMMENT 'from deserializer', ad_network_attribution_impression_view_percent string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', ad_network_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', ad_network_category string COMMENT 'from deserializer', ad_network_certified_partner string COMMENT 'from deserializer', ad_network_created string COMMENT 'from deserializer', ad_network_description string COMMENT 'from deserializer', ad_network_facebook_attribution_string string COMMENT 'from deserializer', ad_network_google_play_attribution_string string COMMENT 'from deserializer', ad_network_id string COMMENT 'from deserializer', ad_network_instructions_url string COMMENT 'from deserializer', ad_network_internal string COMMENT 'from deserializer', ad_network_modified string COMMENT 'from deserializer', ad_network_name string COMMENT 'from deserializer', ad_network_os_type string COMMENT 'from deserializer', ad_network_partner_type string COMMENT 'from deserializer', ad_network_reengagement_window_seconds string COMMENT 'from deserializer', ad_network_signup_url string COMMENT 'from deserializer', ad_network_status string COMMENT 'from deserializer', ad_network_supports_simplified string COMMENT 'from deserializer', ad_network_thumbnail_url string COMMENT 'from deserializer', ad_network_twitter_attribution_string string COMMENT 'from deserializer', ad_network_type string COMMENT 'from deserializer', advertiser_account_id string COMMENT 'from deserializer', advertiser_conversion_key_id string COMMENT 'from deserializer', advertiser_created string COMMENT 'from deserializer', advertiser_description string COMMENT 'from deserializer', advertiser_id string COMMENT 'from deserializer', advertiser_logo_url string COMMENT 'from deserializer', advertiser_logo_url_https string COMMENT 'from deserializer', advertiser_modified string COMMENT 'from deserializer', advertiser_name string COMMENT 'from deserializer', advertiser_ranking string COMMENT 'from deserializer', advertiser_status string COMMENT 'from deserializer', advertiser_time_zone string COMMENT 'from deserializer', advertiser_token string COMMENT 'from deserializer', advertiser_vote_score string COMMENT 'from deserializer', advertiser_votes string COMMENT 'from deserializer', agency_account_id string COMMENT 'from deserializer', agency_contact_email string COMMENT 'from deserializer', agency_contact_name string COMMENT 'from deserializer', agency_contact_phone string COMMENT 'from deserializer', agency_created string COMMENT 'from deserializer', agency_description string COMMENT 'from deserializer', agency_id string COMMENT 'from deserializer', agency_logo_url string COMMENT 'from deserializer', agency_logo_url_https string COMMENT 'from deserializer', agency_media_regions string COMMENT 'from deserializer', agency_modified string COMMENT 'from deserializer', agency_name string COMMENT 'from deserializer', agency_primary_contact_user_id string COMMENT 'from deserializer', agency_region_id string COMMENT 'from deserializer', agency_site_count string COMMENT 'from deserializer', agency_status string COMMENT 'from deserializer', agency_token string COMMENT 'from deserializer', agency_website string COMMENT 'from deserializer', campaign_url_campaign_id string COMMENT 'from deserializer', campaign_url_created string COMMENT 'from deserializer', campaign_url_custom_variables string COMMENT 'from deserializer', campaign_url_id string COMMENT 'from deserializer', campaign_url_is_default string COMMENT 'from deserializer', campaign_url_language_id string COMMENT 'from deserializer', campaign_url_modified string COMMENT 'from deserializer', campaign_url_name string COMMENT 'from deserializer', campaign_url_preview_url string COMMENT 'from deserializer', campaign_url_status string COMMENT 'from deserializer', campaign_url_thumbnail_file_id string COMMENT 'from deserializer', campaign_url_url string COMMENT 'from deserializer', campaign_allow_deep_links string COMMENT 'from deserializer', campaign_approve_conversions string COMMENT 'from deserializer', campaign_composit_ranking string COMMENT 'from deserializer', campaign_conversions_ranking string COMMENT 'from deserializer', campaign_created string COMMENT 'from deserializer', campaign_description string COMMENT 'from deserializer', campaign_epc_ranking string COMMENT 'from deserializer', campaign_expiration_date string COMMENT 'from deserializer', campaign_id string COMMENT 'from deserializer', campaign_incentivizable string COMMENT 'from deserializer', campaign_is_default string COMMENT 'from deserializer', campaign_modified string COMMENT 'from deserializer', campaign_name string COMMENT 'from deserializer', campaign_payout_ranking string COMMENT 'from deserializer', campaign_preview_url string COMMENT 'from deserializer', campaign_publisher_ranking string COMMENT 'from deserializer', campaign_ranking string COMMENT 'from deserializer', campaign_require_approval string COMMENT 'from deserializer', campaign_show_to_publishers string COMMENT 'from deserializer', campaign_site_id string COMMENT 'from deserializer', campaign_start_date string COMMENT 'from deserializer', campaign_status string COMMENT 'from deserializer', campaign_terms_and_conditions string COMMENT 'from deserializer', campaign_thumbnail_file_id string COMMENT 'from deserializer', campaign_vote_score string COMMENT 'from deserializer', country_code string COMMENT 'from deserializer', country_created string COMMENT 'from deserializer', country_id string COMMENT 'from deserializer', country_name string COMMENT 'from deserializer', install_publisher_account_id string COMMENT 'from deserializer', install_publisher_ad_network_id string COMMENT 'from deserializer', install_publisher_attribution_impression_view_percent string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', install_publisher_facebook_attribution_string string COMMENT 'from deserializer', install_publisher_google_play_attribution_string string COMMENT 'from deserializer', install_publisher_id string COMMENT 'from deserializer', install_publisher_internal string COMMENT 'from deserializer', install_publisher_name string COMMENT 'from deserializer', install_publisher_partner_type string COMMENT 'from deserializer', install_publisher_ranking string COMMENT 'from deserializer', install_publisher_reengagement_window_seconds string COMMENT 'from deserializer', install_publisher_status string COMMENT 'from deserializer', install_publisher_twitter_attribution_string string COMMENT 'from deserializer', install_publisher_votes string COMMENT 'from deserializer', publisher_account_id string COMMENT 'from deserializer', publisher_ad_network_id string COMMENT 'from deserializer', publisher_attribution_impression_view_percent string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', publisher_facebook_attribution_string string COMMENT 'from deserializer', publisher_google_play_attribution_string string COMMENT 'from deserializer', publisher_id string COMMENT 'from deserializer', publisher_internal string COMMENT 'from deserializer', publisher_name string COMMENT 'from deserializer', publisher_partner_type string COMMENT 'from deserializer', publisher_ranking string COMMENT 'from deserializer', publisher_reengagement_window_seconds string COMMENT 'from deserializer', publisher_status string COMMENT 'from deserializer', publisher_twitter_attribution_string string COMMENT 'from deserializer', publisher_votes string COMMENT 'from deserializer', region_code string COMMENT 'from deserializer', region_country_id string COMMENT 'from deserializer', region_created string COMMENT 'from deserializer', region_id string COMMENT 'from deserializer', region_name string COMMENT 'from deserializer', site_event_aggregate_revenue string COMMENT 'from deserializer', site_event_created string COMMENT 'from deserializer', site_event_id string COMMENT 'from deserializer', site_event_modified string COMMENT 'from deserializer', site_event_name string COMMENT 'from deserializer', site_event_reengagement_tracking_enabled string COMMENT 'from deserializer', site_event_ref string COMMENT 'from deserializer', site_event_site_id string COMMENT 'from deserializer', site_event_status string COMMENT 'from deserializer', site_event_tracking_type string COMMENT 'from deserializer', site_event_tracking_verified string COMMENT 'from deserializer', site_event_type string COMMENT 'from deserializer', site_app_channel_id string COMMENT 'from deserializer', site_appsfigure_name string COMMENT 'from deserializer', site_conversion_key_id string COMMENT 'from deserializer', site_conversion_redirect_url string COMMENT 'from deserializer', site_created string COMMENT 'from deserializer', site_enable_web_tracking string COMMENT 'from deserializer', site_fb_app_id string COMMENT 'from deserializer', site_google_analytics string COMMENT 'from deserializer', site_id string COMMENT 'from deserializer', site_logo_url string COMMENT 'from deserializer', site_logo_url_https string COMMENT 'from deserializer', site_mobile_app_type string COMMENT 'from deserializer', site_modified string COMMENT 'from deserializer', site_name string COMMENT 'from deserializer', site_package_name string COMMENT 'from deserializer', site_ref_id string COMMENT 'from deserializer', site_status string COMMENT 'from deserializer', site_store_app_id string COMMENT 'from deserializer', site_ui_state string COMMENT 'from deserializer', site_url string COMMENT 'from deserializer') PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ( 'escapeChar'='\\', 'quoteChar'='\"', 'separatorChar'=',') STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/Tune/tune_opens_origin'"
hive -e "msck repair table pardata.tune_opens_origin"
hive -e "drop table pardata.tune_updates_origin"
hive -e "CREATE EXTERNAL TABLE pardata.tune_updates_origin( some_id string COMMENT 'from deserializer', advertiser_file_id string COMMENT 'from deserializer', advertiser_opt_out string COMMENT 'from deserializer', advertiser_ref_id string COMMENT 'from deserializer', advertiser_sub_ad_id string COMMENT 'from deserializer', advertiser_sub_adgroup_id string COMMENT 'from deserializer', advertiser_sub_campaign_id string COMMENT 'from deserializer', advertiser_sub_keyword_id string COMMENT 'from deserializer', advertiser_sub_placement_id string COMMENT 'from deserializer', advertiser_sub_publisher_id string COMMENT 'from deserializer', advertiser_sub_site_id string COMMENT 'from deserializer', age string COMMENT 'from deserializer', altitude string COMMENT 'from deserializer', app_name string COMMENT 'from deserializer', app_version string COMMENT 'from deserializer', campaign_ad_id string COMMENT 'from deserializer', campaign_payout_id string COMMENT 'from deserializer', city_code string COMMENT 'from deserializer', click_gross_count string COMMENT 'from deserializer', click_publishers_count string COMMENT 'from deserializer', click_unique_count string COMMENT 'from deserializer', created string COMMENT 'from deserializer', currency_code string COMMENT 'from deserializer', debug_mode string COMMENT 'from deserializer', device_brand string COMMENT 'from deserializer', device_carrier string COMMENT 'from deserializer', device_id string COMMENT 'from deserializer', device_id_md5 string COMMENT 'from deserializer', device_id_sha1 string COMMENT 'from deserializer', device_id_sha256 string COMMENT 'from deserializer', device_ip string COMMENT 'from deserializer', device_model string COMMENT 'from deserializer', device_type string COMMENT 'from deserializer', existing_user string COMMENT 'from deserializer', fb_user_id string COMMENT 'from deserializer', gender string COMMENT 'from deserializer', google_ad_tracking string COMMENT 'from deserializer', google_aid string COMMENT 'from deserializer', google_aid_md5 string COMMENT 'from deserializer', google_aid_sha1 string COMMENT 'from deserializer', google_aid_sha256 string COMMENT 'from deserializer', google_user_id string COMMENT 'from deserializer', id string COMMENT 'from deserializer', impression_created string COMMENT 'from deserializer', impression_gross_count string COMMENT 'from deserializer', impression_publishers_count string COMMENT 'from deserializer', impression_unique_count string COMMENT 'from deserializer', install_created string COMMENT 'from deserializer', install_date string COMMENT 'from deserializer', install_stat_click_id string COMMENT 'from deserializer', ios_ad_tracking string COMMENT 'from deserializer', ios_ifa string COMMENT 'from deserializer', ios_ifa_md5 string COMMENT 'from deserializer', ios_ifa_sha1 string COMMENT 'from deserializer', ios_ifa_sha256 string COMMENT 'from deserializer', ios_ifv string COMMENT 'from deserializer', ios_ifv_md5 string COMMENT 'from deserializer', ios_ifv_sha1 string COMMENT 'from deserializer', ip string COMMENT 'from deserializer', is_assist string COMMENT 'from deserializer', is_reengagement string COMMENT 'from deserializer', is_unique string COMMENT 'from deserializer', is_view_through string COMMENT 'from deserializer', language string COMMENT 'from deserializer', latitude string COMMENT 'from deserializer', longitude string COMMENT 'from deserializer', mac_address string COMMENT 'from deserializer', mac_address_md5 string COMMENT 'from deserializer', mac_address_sha1 string COMMENT 'from deserializer', mat_id string COMMENT 'from deserializer', match_type string COMMENT 'from deserializer', metro_code string COMMENT 'from deserializer', odin string COMMENT 'from deserializer', os_id string COMMENT 'from deserializer', os_id_md5 string COMMENT 'from deserializer', os_id_sha1 string COMMENT 'from deserializer', os_id_sha256 string COMMENT 'from deserializer', os_jailbroke string COMMENT 'from deserializer', os_version string COMMENT 'from deserializer', package_name string COMMENT 'from deserializer', payout string COMMENT 'from deserializer', postal_code string COMMENT 'from deserializer', publisher_adgroup_id string COMMENT 'from deserializer', publisher_click_id string COMMENT 'from deserializer', publisher_ref_id string COMMENT 'from deserializer', publisher_sub1 string COMMENT 'from deserializer', publisher_sub2 string COMMENT 'from deserializer', publisher_sub3 string COMMENT 'from deserializer', publisher_sub4 string COMMENT 'from deserializer', publisher_sub5 string COMMENT 'from deserializer', publisher_sub_ad_id string COMMENT 'from deserializer', publisher_sub_adgroup_id string COMMENT 'from deserializer', publisher_sub_campaign_id string COMMENT 'from deserializer', publisher_sub_keyword_id string COMMENT 'from deserializer', publisher_sub_placement_id string COMMENT 'from deserializer', publisher_sub_publisher_id string COMMENT 'from deserializer', publisher_sub_site_id string COMMENT 'from deserializer', referral_source string COMMENT 'from deserializer', referral_url string COMMENT 'from deserializer', request_url string COMMENT 'from deserializer', revenue string COMMENT 'from deserializer', revenue_usd string COMMENT 'from deserializer', sdk string COMMENT 'from deserializer', sdk_version string COMMENT 'from deserializer', session_datetime string COMMENT 'from deserializer', session_ip string COMMENT 'from deserializer', site_event_items_count string COMMENT 'from deserializer', site_event_offset string COMMENT 'from deserializer', site_offset string COMMENT 'from deserializer', stat_click_id string COMMENT 'from deserializer', stat_impression_id string COMMENT 'from deserializer', stat_install_id string COMMENT 'from deserializer', status string COMMENT 'from deserializer', status_code string COMMENT 'from deserializer', test_profile_id string COMMENT 'from deserializer', tracking_id string COMMENT 'from deserializer', transaction_id string COMMENT 'from deserializer', twitter_user_id string COMMENT 'from deserializer', unid string COMMENT 'from deserializer', unique_partner string COMMENT 'from deserializer', user_agent string COMMENT 'from deserializer', user_email string COMMENT 'from deserializer', user_email_md5 string COMMENT 'from deserializer', user_email_sha1 string COMMENT 'from deserializer', user_id string COMMENT 'from deserializer', user_id_md5 string COMMENT 'from deserializer', user_id_sha1 string COMMENT 'from deserializer', user_phone_md5 string COMMENT 'from deserializer', user_phone_sha1 string COMMENT 'from deserializer', user_phone_sha256 string COMMENT 'from deserializer', username string COMMENT 'from deserializer', username_md5 string COMMENT 'from deserializer', username_sha1 string COMMENT 'from deserializer', windows_aid string COMMENT 'from deserializer', windows_aid_md5 string COMMENT 'from deserializer', windows_aid_sha1 string COMMENT 'from deserializer', windows_aid_sha256 string COMMENT 'from deserializer', wurfl_brand_name string COMMENT 'from deserializer', wurfl_device_os string COMMENT 'from deserializer', wurfl_device_os_version string COMMENT 'from deserializer', wurfl_model_name string COMMENT 'from deserializer', ad_network_ad_formats string COMMENT 'from deserializer', ad_network_attribution_impression_view_percent string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', ad_network_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', ad_network_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', ad_network_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', ad_network_category string COMMENT 'from deserializer', ad_network_certified_partner string COMMENT 'from deserializer', ad_network_created string COMMENT 'from deserializer', ad_network_description string COMMENT 'from deserializer', ad_network_facebook_attribution_string string COMMENT 'from deserializer', ad_network_google_play_attribution_string string COMMENT 'from deserializer', ad_network_id string COMMENT 'from deserializer', ad_network_instructions_url string COMMENT 'from deserializer', ad_network_internal string COMMENT 'from deserializer', ad_network_modified string COMMENT 'from deserializer', ad_network_name string COMMENT 'from deserializer', ad_network_os_type string COMMENT 'from deserializer', ad_network_partner_type string COMMENT 'from deserializer', ad_network_reengagement_window_seconds string COMMENT 'from deserializer', ad_network_signup_url string COMMENT 'from deserializer', ad_network_status string COMMENT 'from deserializer', ad_network_supports_simplified string COMMENT 'from deserializer', ad_network_thumbnail_url string COMMENT 'from deserializer', ad_network_twitter_attribution_string string COMMENT 'from deserializer', ad_network_type string COMMENT 'from deserializer', advertiser_account_id string COMMENT 'from deserializer', advertiser_conversion_key_id string COMMENT 'from deserializer', advertiser_created string COMMENT 'from deserializer', advertiser_description string COMMENT 'from deserializer', advertiser_id string COMMENT 'from deserializer', advertiser_logo_url string COMMENT 'from deserializer', advertiser_logo_url_https string COMMENT 'from deserializer', advertiser_modified string COMMENT 'from deserializer', advertiser_name string COMMENT 'from deserializer', advertiser_ranking string COMMENT 'from deserializer', advertiser_status string COMMENT 'from deserializer', advertiser_time_zone string COMMENT 'from deserializer', advertiser_token string COMMENT 'from deserializer', advertiser_vote_score string COMMENT 'from deserializer', advertiser_votes string COMMENT 'from deserializer', agency_account_id string COMMENT 'from deserializer', agency_contact_email string COMMENT 'from deserializer', agency_contact_name string COMMENT 'from deserializer', agency_contact_phone string COMMENT 'from deserializer', agency_created string COMMENT 'from deserializer', agency_description string COMMENT 'from deserializer', agency_id string COMMENT 'from deserializer', agency_logo_url string COMMENT 'from deserializer', agency_logo_url_https string COMMENT 'from deserializer', agency_media_regions string COMMENT 'from deserializer', agency_modified string COMMENT 'from deserializer', agency_name string COMMENT 'from deserializer', agency_primary_contact_user_id string COMMENT 'from deserializer', agency_region_id string COMMENT 'from deserializer', agency_site_count string COMMENT 'from deserializer', agency_status string COMMENT 'from deserializer', agency_token string COMMENT 'from deserializer', agency_website string COMMENT 'from deserializer', campaign_url_campaign_id string COMMENT 'from deserializer', campaign_url_created string COMMENT 'from deserializer', campaign_url_custom_variables string COMMENT 'from deserializer', campaign_url_id string COMMENT 'from deserializer', campaign_url_is_default string COMMENT 'from deserializer', campaign_url_language_id string COMMENT 'from deserializer', campaign_url_modified string COMMENT 'from deserializer', campaign_url_name string COMMENT 'from deserializer', campaign_url_preview_url string COMMENT 'from deserializer', campaign_url_status string COMMENT 'from deserializer', campaign_url_thumbnail_file_id string COMMENT 'from deserializer', campaign_url_url string COMMENT 'from deserializer', campaign_allow_deep_links string COMMENT 'from deserializer', campaign_approve_conversions string COMMENT 'from deserializer', campaign_composit_ranking string COMMENT 'from deserializer', campaign_conversions_ranking string COMMENT 'from deserializer', campaign_created string COMMENT 'from deserializer', campaign_description string COMMENT 'from deserializer', campaign_epc_ranking string COMMENT 'from deserializer', campaign_expiration_date string COMMENT 'from deserializer', campaign_id string COMMENT 'from deserializer', campaign_incentivizable string COMMENT 'from deserializer', campaign_is_default string COMMENT 'from deserializer', campaign_modified string COMMENT 'from deserializer', campaign_name string COMMENT 'from deserializer', campaign_payout_ranking string COMMENT 'from deserializer', campaign_preview_url string COMMENT 'from deserializer', campaign_publisher_ranking string COMMENT 'from deserializer', campaign_ranking string COMMENT 'from deserializer', campaign_require_approval string COMMENT 'from deserializer', campaign_show_to_publishers string COMMENT 'from deserializer', campaign_site_id string COMMENT 'from deserializer', campaign_start_date string COMMENT 'from deserializer', campaign_status string COMMENT 'from deserializer', campaign_terms_and_conditions string COMMENT 'from deserializer', campaign_thumbnail_file_id string COMMENT 'from deserializer', campaign_vote_score string COMMENT 'from deserializer', country_code string COMMENT 'from deserializer', country_created string COMMENT 'from deserializer', country_id string COMMENT 'from deserializer', country_name string COMMENT 'from deserializer', install_publisher_account_id string COMMENT 'from deserializer', install_publisher_ad_network_id string COMMENT 'from deserializer', install_publisher_attribution_impression_view_percent string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', install_publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', install_publisher_facebook_attribution_string string COMMENT 'from deserializer', install_publisher_google_play_attribution_string string COMMENT 'from deserializer', install_publisher_id string COMMENT 'from deserializer', install_publisher_internal string COMMENT 'from deserializer', install_publisher_name string COMMENT 'from deserializer', install_publisher_partner_type string COMMENT 'from deserializer', install_publisher_ranking string COMMENT 'from deserializer', install_publisher_reengagement_window_seconds string COMMENT 'from deserializer', install_publisher_status string COMMENT 'from deserializer', install_publisher_twitter_attribution_string string COMMENT 'from deserializer', install_publisher_votes string COMMENT 'from deserializer', publisher_account_id string COMMENT 'from deserializer', publisher_ad_network_id string COMMENT 'from deserializer', publisher_attribution_impression_view_percent string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_click_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_facebook string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_fingerprint string COMMENT 'from deserializer', publisher_attribution_window_seconds_impression_identifiers string COMMENT 'from deserializer', publisher_attribution_window_seconds_referrer_session string COMMENT 'from deserializer', publisher_attribution_window_seconds_tracking_id_session string COMMENT 'from deserializer', publisher_facebook_attribution_string string COMMENT 'from deserializer', publisher_google_play_attribution_string string COMMENT 'from deserializer', publisher_id string COMMENT 'from deserializer', publisher_internal string COMMENT 'from deserializer', publisher_name string COMMENT 'from deserializer', publisher_partner_type string COMMENT 'from deserializer', publisher_ranking string COMMENT 'from deserializer', publisher_reengagement_window_seconds string COMMENT 'from deserializer', publisher_status string COMMENT 'from deserializer', publisher_twitter_attribution_string string COMMENT 'from deserializer', publisher_votes string COMMENT 'from deserializer', region_code string COMMENT 'from deserializer', region_country_id string COMMENT 'from deserializer', region_created string COMMENT 'from deserializer', region_id string COMMENT 'from deserializer', region_name string COMMENT 'from deserializer', site_event_aggregate_revenue string COMMENT 'from deserializer', site_event_created string COMMENT 'from deserializer', site_event_id string COMMENT 'from deserializer', site_event_modified string COMMENT 'from deserializer', site_event_name string COMMENT 'from deserializer', site_event_reengagement_tracking_enabled string COMMENT 'from deserializer', site_event_ref string COMMENT 'from deserializer', site_event_site_id string COMMENT 'from deserializer', site_event_status string COMMENT 'from deserializer', site_event_tracking_type string COMMENT 'from deserializer', site_event_tracking_verified string COMMENT 'from deserializer', site_event_type string COMMENT 'from deserializer', site_app_channel_id string COMMENT 'from deserializer', site_appsfigure_name string COMMENT 'from deserializer', site_conversion_key_id string COMMENT 'from deserializer', site_conversion_redirect_url string COMMENT 'from deserializer', site_created string COMMENT 'from deserializer', site_enable_web_tracking string COMMENT 'from deserializer', site_fb_app_id string COMMENT 'from deserializer', site_google_analytics string COMMENT 'from deserializer', site_id string COMMENT 'from deserializer', site_logo_url string COMMENT 'from deserializer', site_logo_url_https string COMMENT 'from deserializer', site_mobile_app_type string COMMENT 'from deserializer', site_modified string COMMENT 'from deserializer', site_name string COMMENT 'from deserializer', site_package_name string COMMENT 'from deserializer', site_ref_id string COMMENT 'from deserializer', site_status string COMMENT 'from deserializer', site_store_app_id string COMMENT 'from deserializer', site_ui_state string COMMENT 'from deserializer', site_url string COMMENT 'from deserializer') PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' WITH SERDEPROPERTIES ( 'escapeChar'='\\', 'quoteChar'='\"', 'separatorChar'=',') STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.input.prod/dmp.3rdparty/Tune/tune_updates_origin'"
hive -e "msck repair table pardata.tune_updates_origin"
hive -e "drop table temp.app_log_country_test"
hive -e "CREATE EXTERNAL TABLE temp.app_log_country_test( country string, connection_type string, latlon_source string, brand string, app_cat string, imei string) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.data.temp/gil_temp/app_log_country_test'"
hive -e "msck repair table temp.app_log_country_test"
hive -e "drop table temp.profile_basis_country_test"
hive -e "CREATE EXTERNAL TABLE temp.profile_basis_country_test( country string, sdk_name string, create_at_hr int, app_cat string, imei string, reqs bigint, imps_effective bigint) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.data.temp/gil_temp/profile_basis_country_test'"
hive -e "msck repair table temp.profile_basis_country_test"
hive -e "drop table temp.profile_basis_country_test2"
hive -e "CREATE EXTERNAL TABLE temp.profile_basis_country_test2( country string, sdk_name string, create_at_hr int, app_cat string, imei string, reqs bigint, imps_effective bigint) ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.data.temp/gil_temp/profile_basis_country_test2'"
hive -e "msck repair table temp.profile_basis_country_test2"
hive -e "drop table temp.profile_device_app_detection_date_range"
hive -e "CREATE EXTERNAL TABLE temp.profile_device_app_detection_date_range( pkg string, dt_min string, dt_max string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp/hive/warehouse/temp.profile_device_app_detection_date_range'"
hive -e "msck repair table temp.profile_device_app_detection_date_range"
hive -e "drop table temp.profile_device_app_detection_gaid_uu"
hive -e "CREATE EXTERNAL TABLE temp.profile_device_app_detection_gaid_uu( pkg string, gaid string) PARTITIONED BY ( dt string) ROW FORMAT SERDE 'org.apache.hadoop.hive.ql.io.parquet.serde.ParquetHiveSerDe' STORED AS INPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.parquet.MapredParquetOutputFormat' LOCATION 's3://vpon.dmp/hive/warehouse/temp.profile_device_app_detection_gaid_uu'"
hive -e "msck repair table temp.profile_device_app_detection_gaid_uu"
hive -e "drop table temp.profile_device_browser_dt"
hive -e "CREATE EXTERNAL TABLE temp.profile_device_browser_dt( sdk_name string, imei string, browser string) PARTITIONED BY ( dt string) ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t' LINES TERMINATED BY '\n' STORED AS INPUTFORMAT 'org.apache.hadoop.mapred.TextInputFormat' OUTPUTFORMAT 'org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat' LOCATION 's3://vpon.dmp.output.prod/ETL/profile_device_browser_dt'"
hive -e "msck repair table temp.profile_device_browser_dt"
